{"version":3,"file":"metaScore.Editor.umd.251.js","mappings":"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","sources":["webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/utils/automaticdecorators.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/utils/index.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/addbehaviortriggercommand.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/removebehaviortriggercommand.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/behaviortriggerediting.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/ui/behaviortriggerformview.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/theme/icons/removebehaviortrigger.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/ui/behaviortriggeractionsview.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/theme/icons/addbehaviortrigger.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/behaviortriggerui.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/behaviortrigger.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-behaviortrigger/src/index.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/linkcommand.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/linkediting.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/autolink.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/ui/inputtimecodeview.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/ui/utils.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/ui/formgroupview.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/theme/icons/clear.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/theme/icons/in.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/theme/icons/out.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/ui/labeledtimecodefieldview.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/theme/icons/tip.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/ui/linkformview.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/theme/icons/link.svg","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/linkui.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/link.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/linkimageediting.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/linkimageui.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/linkimage.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-link/src/index.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-sourceediting/src/sourceediting.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-sourceediting/src/index.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-uploadadapter/src/adapter.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-uploadadapter/src/uploadadapter.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/plugins/ckeditor5-uploadadapter/src/index.js","webpack://metaScore/./packages/editor/modules/component_form/ckeditor/index.js","webpack://metaScore/./node_modules/@ckeditor/ckeditor5-link/theme/icons/unlink.svg"],"sourcesContent":["/**\n * Helper class that ties together all {@link module:link/link~LinkDecoratorAutomaticDefinition} and provides\n * the {@link module:engine/conversion/downcasthelpers~DowncastHelpers#attributeToElement downcast dispatchers} for them.\n */\nexport default class AutomaticDecorators {\n  constructor() {\n    /**\n     * Stores the definition of {@link module:link/link~LinkDecoratorAutomaticDefinition automatic decorators}.\n     * This data is used as a source for a downcast dispatcher to create a proper conversion to output data.\n     *\n     * @private\n     * @type {Set}\n     */\n    this._definitions = new Set();\n  }\n\n  /**\n   * Gives information about the number of decorators stored in the {@link module:link/utils~AutomaticDecorators} instance.\n   *\n   * @readonly\n   * @protected\n   * @type {Number}\n   */\n  get length() {\n    return this._definitions.size;\n  }\n\n  /**\n   * Adds automatic decorator objects or an array with them to be used during downcasting.\n   *\n   * @param {module:link/link~LinkDecoratorAutomaticDefinition|Array.<module:link/link~LinkDecoratorAutomaticDefinition>} item\n   * A configuration object of automatic rules for decorating links. It might also be an array of such objects.\n   */\n  add(item) {\n    if (Array.isArray(item)) {\n      item.forEach((item) => this._definitions.add(item));\n    } else {\n      this._definitions.add(item);\n    }\n  }\n\n  /**\n   * Provides the conversion helper used in the {@link module:engine/conversion/downcasthelpers~DowncastHelpers#add} method.\n   *\n   * @returns {Function} A dispatcher function used as conversion helper\n   * in {@link module:engine/conversion/downcasthelpers~DowncastHelpers#add}.\n   */\n  getDispatcher() {\n    return (dispatcher) => {\n      dispatcher.on(\n        \"attribute:behaviorTrigger\",\n        (evt, data, conversionApi) => {\n          // There is only test as this behavior decorates links and\n          // it is run before dispatcher which actually consumes this node.\n          // This allows on writing own dispatcher with highest priority,\n          // which blocks both native converter and this additional decoration.\n          if (\n            !conversionApi.consumable.test(\n              data.item,\n              \"attribute:behaviorTrigger\"\n            )\n          ) {\n            return;\n          }\n\n          // Automatic decorators for block links are handled e.g. in LinkImageEditing.\n          if (\n            !(\n              data.item.is(\"selection\") ||\n              conversionApi.schema.isInline(data.item)\n            )\n          ) {\n            return;\n          }\n\n          const viewWriter = conversionApi.writer;\n          const viewSelection = viewWriter.document.selection;\n\n          for (const item of this._definitions) {\n            const viewElement = viewWriter.createAttributeElement(\n              \"a\",\n              item.attributes,\n              {\n                priority: 5,\n              }\n            );\n\n            if (item.classes) {\n              viewWriter.addClass(item.classes, viewElement);\n            }\n\n            for (const key in item.styles) {\n              viewWriter.setStyle(key, item.styles[key], viewElement);\n            }\n\n            viewWriter.setCustomProperty(\"behaviorTrigger\", true, viewElement);\n            if (item.callback(data.attributeNewValue)) {\n              if (data.item.is(\"selection\")) {\n                viewWriter.wrap(viewSelection.getFirstRange(), viewElement);\n              } else {\n                viewWriter.wrap(\n                  conversionApi.mapper.toViewRange(data.range),\n                  viewElement\n                );\n              }\n            } else {\n              viewWriter.unwrap(\n                conversionApi.mapper.toViewRange(data.range),\n                viewElement\n              );\n            }\n          }\n        },\n        { priority: \"high\" }\n      );\n    };\n  }\n}\n","import { upperFirst } from \"lodash-es\";\n\nexport { default as AutomaticDecorators } from \"./automaticdecorators\";\n\n/**\n * A keystroke used by the {@link module:link/linkui~LinkUI link UI feature}.\n */\nexport const TRIGGER_KEYSTROKE = \"Ctrl+T\";\n\n/**\n * Returns `true` if a given view node is the link element.\n *\n * @param {module:engine/view/node~Node} node\n * @returns {Boolean}\n */\nexport function isLinkElement(node) {\n  return (\n    node.is(\"attributeElement\") && !!node.getCustomProperty(\"behaviorTrigger\")\n  );\n}\n\n/**\n * Creates a behavior trigger with the provided `id` attribute.\n *\n * @param {String} id\n * @param {module:engine/conversion/downcastdispatcher~DowncastConversionApi} conversionApi\n * @returns {module:engine/view/attributeelement~AttributeElement}\n */\nexport function createBehaviorTriggerElement(id, { writer }) {\n  // Priority 5 - https://github.com/ckeditor/ckeditor5-link/issues/121.\n  const behaviorTriggerElement = writer.createAttributeElement(\n    \"a\",\n    { \"data-behavior-trigger\": id },\n    { priority: 5 }\n  );\n  writer.setCustomProperty(\"behaviorTrigger\", true, behaviorTriggerElement);\n\n  return behaviorTriggerElement;\n}\n\n/**\n * Converts an object with defined decorators to a normalized array of decorators. The `id` key is added for each decorator and\n * is used as the attribute's name in the model.\n *\n * @param {Object.<String, module:link/link~LinkDecoratorDefinition>} decorators\n * @returns {Array.<module:link/link~LinkDecoratorDefinition>}\n */\nexport function normalizeDecorators(decorators) {\n  const retArray = [];\n\n  if (decorators) {\n    for (const [key, value] of Object.entries(decorators)) {\n      const decorator = Object.assign({}, value, {\n        id: `link${upperFirst(key)}`,\n      });\n      retArray.push(decorator);\n    }\n  }\n\n  return retArray;\n}\n\n/**\n * Returns `true` if the specified `element` can be linked (the element allows the `behaviorTrigger` attribute).\n *\n * @params {module:engine/model/element~Element|null} element\n * @params {module:engine/model/schema~Schema} schema\n * @returns {Boolean}\n */\nexport function isTriggerableElement(element, schema) {\n  if (!element) {\n    return false;\n  }\n\n  return schema.checkAttribute(element.name, \"behaviorTrigger\");\n}\n","import { Command } from \"@ckeditor/ckeditor5-core\";\nimport { findAttributeRange } from \"@ckeditor/ckeditor5-typing\";\nimport { Collection, first, toMap } from \"@ckeditor/ckeditor5-utils\";\n\nimport { AutomaticDecorators, isTriggerableElement } from \"./utils\";\n\n/**\n * The link command. It is used by the {@link module:link/link~Link link feature}.\n *\n * @extends module:core/command~Command\n */\nexport default class AddBehaviorTriggerCommand extends Command {\n  /**\n   * The value of the `'behaviorTrigger'` attribute if the start of the selection is located in a node with this attribute.\n   *\n   * @observable\n   * @readonly\n   * @member {Object|undefined} #value\n   */\n\n  constructor(editor) {\n    super(editor);\n\n    /**\n     * A collection of {@link module:link/utils~ManualDecorator manual decorators}\n     * corresponding to the {@link module:link/link~LinkConfig#decorators decorator configuration}.\n     *\n     * You can consider it a model with states of manual decorators added to the currently selected link.\n     *\n     * @readonly\n     * @type {module:utils/collection~Collection}\n     */\n    this.manualDecorators = new Collection();\n\n    /**\n     * An instance of the helper that ties together all {@link module:link/link~LinkDecoratorAutomaticDefinition}\n     * that are used by the {@glink features/link link} and the {@glink features/images/images-linking linking images} features.\n     *\n     * @readonly\n     * @type {module:link/utils~AutomaticDecorators}\n     */\n    this.automaticDecorators = new AutomaticDecorators();\n  }\n\n  /**\n   * Synchronizes the state of {@link #manualDecorators} with the currently present elements in the model.\n   */\n  restoreManualDecoratorStates() {\n    for (const manualDecorator of this.manualDecorators) {\n      manualDecorator.value = this._getDecoratorStateFromModel(\n        manualDecorator.id\n      );\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedElement =\n      selection.getSelectedElement() || first(selection.getSelectedBlocks());\n\n    // A check for any integration that allows linking elements (e.g. `LinkImage`).\n    // Currently the selection reads attributes from text nodes only. See #7429 and #7465.\n    if (isTriggerableElement(selectedElement, model.schema)) {\n      this.value = selectedElement.getAttribute(\"behaviorTrigger\");\n      this.isEnabled = model.schema.checkAttribute(\n        selectedElement,\n        \"behaviorTrigger\"\n      );\n    } else {\n      this.value = selection.getAttribute(\"behaviorTrigger\");\n      this.isEnabled = model.schema.checkAttributeInSelection(\n        selection,\n        \"behaviorTrigger\"\n      );\n    }\n\n    for (const manualDecorator of this.manualDecorators) {\n      manualDecorator.value = this._getDecoratorStateFromModel(\n        manualDecorator.id\n      );\n    }\n  }\n\n  /**\n   * Executes the command.\n   *\n   * When the selection is non-collapsed, the `behaviorTrigger` attribute will be applied to nodes inside the selection, but only to\n   * those nodes where the `behaviorTrigger` attribute is allowed (disallowed nodes will be omitted).\n   *\n   * When the selection is collapsed and is not inside the text with the `behaviorTrigger` attribute, a\n   * new {@link module:engine/model/text~Text text node} with the `behaviorTrigger` attribute will be inserted in place of the caret, but\n   * only if such element is allowed in this place. The `_data` of the inserted text will equal the `href` parameter.\n   * The selection will be updated to wrap the just inserted text node.\n   *\n   * When the selection is collapsed and inside the text with the `behaviorTrigger` attribute, the attribute value will be updated.\n   *\n   * # Decorators and model attribute management\n   *\n   * There is an optional argument to this command that applies or removes model\n   * {@glink framework/guides/architecture/editing-engine#text-attributes text attributes} brought by\n   * {@link module:link/utils~ManualDecorator manual link decorators}.\n   *\n   * Text attribute names in the model correspond to the entries in the {@link module:link/link~LinkConfig#decorators configuration}.\n   * For every decorator configured, a model text attribute exists with the \"link\" prefix. For example, a `'linkMyDecorator'` attribute\n   * corresponds to `'myDecorator'` in the configuration.\n   *\n   * To learn more about link decorators, check out the {@link module:link/link~LinkConfig#decorators `config.link.decorators`}\n   * documentation.\n   *\n   * Here is how to manage decorator attributes with the addBehaviorTrigger command:\n   *\n   *\t\tconst addBehaviorTriggerCommand = editor.commands.get( 'addBehaviorTrigger' );\n   *\n   *\t\t// Adding a new decorator attribute.\n   *\t\taddBehaviorTriggerCommand.execute( 'my-trigger-id');\n   *\n   * **Note**: If the decorator attribute name is not specified, its state remains untouched.\n   *\n   * **Note**: {@link module:link/removeBehaviorTriggerCommand~RemoveBehaviorTriggerCommand#execute `RemoveBehaviorTriggerCommand#execute()`} removes all\n   * decorator attributes.\n   *\n   * @fires execute\n   * @param {String} id Trigger id.\n   * @param {Object} [manualDecoratorIds={}] The information about manual decorator attributes to be applied or removed upon execution.\n   */\n  execute(id, manualDecoratorIds = {}) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    // Stores information about manual decorators to turn them on/off when command is applied.\n    const truthyManualDecorators = [];\n    const falsyManualDecorators = [];\n\n    for (const name in manualDecoratorIds) {\n      if (manualDecoratorIds[name]) {\n        truthyManualDecorators.push(name);\n      } else {\n        falsyManualDecorators.push(name);\n      }\n    }\n\n    model.change((writer) => {\n      // If selection is collapsed then update selected link or insert new one at the place of caret.\n      if (selection.isCollapsed) {\n        const position = selection.getFirstPosition();\n\n        // When selection is inside text with `behaviorTrigger` attribute.\n        if (selection.hasAttribute(\"behaviorTrigger\")) {\n          // Then update `behaviorTrigger` value.\n          const linkRange = findAttributeRange(\n            position,\n            \"behaviorTrigger\",\n            selection.getAttribute(\"behaviorTrigger\"),\n            model\n          );\n\n          writer.setAttribute(\"behaviorTrigger\", id, linkRange);\n\n          truthyManualDecorators.forEach((item) => {\n            writer.setAttribute(item, true, linkRange);\n          });\n\n          falsyManualDecorators.forEach((item) => {\n            writer.removeAttribute(item, linkRange);\n          });\n\n          // Put the selection at the end of the updated link.\n          writer.setSelection(\n            writer.createPositionAfter(linkRange.end.nodeBefore)\n          );\n        }\n        // If not then insert text node with `behaviorTrigger` attribute in place of caret.\n        // However, since selection is collapsed, attribute value will be used as data for text node.\n        // So, if `id` is empty, do not create text node.\n        else if (id !== \"\") {\n          const attributes = toMap(selection.getAttributes());\n\n          attributes.set(\"behaviorTrigger\", id);\n\n          truthyManualDecorators.forEach((item) => {\n            attributes.set(item, true);\n          });\n\n          const { end: positionAfter } = model.insertContent(\n            writer.createText(id, attributes),\n            position\n          );\n\n          // Put the selection at the end of the inserted link.\n          // Using end of range returned from insertContent in case nodes with the same attributes got merged.\n          writer.setSelection(positionAfter);\n        }\n\n        // Remove the `behaviorTrigger` attribute and all link decorators from the selection.\n        // It stops adding a new content into the link element.\n        [\n          \"behaviorTrigger\",\n          ...truthyManualDecorators,\n          ...falsyManualDecorators,\n        ].forEach((item) => {\n          writer.removeSelectionAttribute(item);\n        });\n      } else {\n        // If selection has non-collapsed ranges, we change attribute on nodes inside those ranges\n        // omitting nodes where the `behaviorTrigger` attribute is disallowed.\n        const ranges = model.schema.getValidRanges(\n          selection.getRanges(),\n          \"behaviorTrigger\"\n        );\n\n        // But for the first, check whether the `behaviorTrigger` attribute is allowed on selected blocks (e.g. the \"image\" element).\n        const allowedRanges = [];\n\n        for (const element of selection.getSelectedBlocks()) {\n          if (model.schema.checkAttribute(element, \"behaviorTrigger\")) {\n            allowedRanges.push(writer.createRangeOn(element));\n          }\n        }\n\n        // Ranges that accept the `behaviorTrigger` attribute. Since we will iterate over `allowedRanges`, let's clone it.\n        const rangesToUpdate = allowedRanges.slice();\n\n        // For all selection ranges we want to check whether given range is inside an element that accepts the `behaviorTrigger` attribute.\n        // If so, we don't want to propagate applying the attribute to its children.\n        for (const range of ranges) {\n          if (this._isRangeToUpdate(range, allowedRanges)) {\n            rangesToUpdate.push(range);\n          }\n        }\n\n        for (const range of rangesToUpdate) {\n          writer.setAttribute(\"behaviorTrigger\", id, range);\n\n          truthyManualDecorators.forEach((item) => {\n            writer.setAttribute(item, true, range);\n          });\n\n          falsyManualDecorators.forEach((item) => {\n            writer.removeAttribute(item, range);\n          });\n        }\n      }\n    });\n  }\n\n  /**\n   * Provides information whether a decorator with a given name is present in the currently processed selection.\n   *\n   * @private\n   * @param {String} decoratorName The name of the manual decorator used in the model\n   * @returns {Boolean} The information whether a given decorator is currently present in the selection.\n   */\n  _getDecoratorStateFromModel(decoratorName) {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedElement = selection.getSelectedElement();\n\n    // A check for the `LinkImage` plugin. If the selection contains an element, get values from the element.\n    // Currently the selection reads attributes from text nodes only. See #7429 and #7465.\n    if (isTriggerableElement(selectedElement, model.schema)) {\n      return selectedElement.getAttribute(decoratorName);\n    }\n\n    return selection.getAttribute(decoratorName);\n  }\n\n  /**\n   * Checks whether specified `range` is inside an element that accepts the `behaviorTrigger` attribute.\n   *\n   * @private\n   * @param {module:engine/view/range~Range} range A range to check.\n   * @param {Array.<module:engine/view/range~Range>} allowedRanges An array of ranges created on elements where the attribute is accepted.\n   * @returns {Boolean}\n   */\n  _isRangeToUpdate(range, allowedRanges) {\n    for (const allowedRange of allowedRanges) {\n      // A range is inside an element that will have the `behaviorTrigger` attribute. Do not modify its nodes.\n      if (allowedRange.containsRange(range)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n}\n","import { Command } from \"@ckeditor/ckeditor5-core\";\nimport { findAttributeRange } from \"@ckeditor/ckeditor5-typing\";\n\nimport { isTriggerableElement } from \"./utils\";\n\n/**\n * The unlink command. It is used by the {@link module:link/link~Link link plugin}.\n *\n * @extends module:core/command~Command\n */\nexport default class RemoveBehaviorTriggerCommand extends Command {\n  /**\n   * @inheritDoc\n   */\n  refresh() {\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const selectedElement = selection.getSelectedElement();\n\n    // A check for any integration that allows linking elements (e.g. `LinkImage`).\n    // Currently the selection reads attributes from text nodes only. See #7429 and #7465.\n    if (isTriggerableElement(selectedElement, model.schema)) {\n      this.isEnabled = model.schema.checkAttribute(\n        selectedElement,\n        \"behaviorTrigger\"\n      );\n    } else {\n      this.isEnabled = model.schema.checkAttributeInSelection(\n        selection,\n        \"behaviorTrigger\"\n      );\n    }\n  }\n\n  /**\n   * Executes the command.\n   *\n   * When the selection is collapsed, it removes the `behaviorTrigger` attribute from each node with the same `behaviorTrigger` attribute value.\n   * When the selection is non-collapsed, it removes the `behaviorTrigger` attribute from each node in selected ranges.\n   *\n   * # Decorators\n   *\n   * If {@link module:link/link~LinkConfig#decorators `config.link.decorators`} is specified,\n   * all configured decorators are removed together with the `behaviorTrigger` attribute.\n   *\n   * @fires execute\n   */\n  execute() {\n    const editor = this.editor;\n    const model = this.editor.model;\n    const selection = model.document.selection;\n    const addBehaviorTriggerCommand = editor.commands.get(\"addBehaviorTrigger\");\n\n    model.change((writer) => {\n      // Get ranges to unlink.\n      const rangesToUnlink = selection.isCollapsed\n        ? [\n            findAttributeRange(\n              selection.getFirstPosition(),\n              \"behaviorTrigger\",\n              selection.getAttribute(\"behaviorTrigger\"),\n              model\n            ),\n          ]\n        : model.schema.getValidRanges(selection.getRanges(), \"behaviorTrigger\");\n\n      // Remove `behaviorTrigger` attribute from specified ranges.\n      for (const range of rangesToUnlink) {\n        writer.removeAttribute(\"behaviorTrigger\", range);\n        // If there are registered custom attributes, then remove them during unlink.\n        if (addBehaviorTriggerCommand) {\n          for (const manualDecorator of addBehaviorTriggerCommand.manualDecorators) {\n            writer.removeAttribute(manualDecorator.id, range);\n          }\n        }\n      }\n    });\n  }\n}\n","import { Plugin } from \"@ckeditor/ckeditor5-core\";\nimport { MouseObserver } from \"@ckeditor/ckeditor5-engine\";\nimport { Input } from \"@ckeditor/ckeditor5-typing\";\nimport { TwoStepCaretMovement } from \"@ckeditor/ckeditor5-typing\";\nimport { inlineHighlight } from \"@ckeditor/ckeditor5-typing\";\nimport { findAttributeRange } from \"@ckeditor/ckeditor5-typing\";\nimport { ClipboardPipeline } from \"@ckeditor/ckeditor5-clipboard\";\nimport { keyCodes } from \"@ckeditor/ckeditor5-utils\";\n\nimport AddBehaviorTriggerCommand from \"./addbehaviortriggercommand\";\nimport RemoveBehaviorTriggerCommand from \"./removebehaviortriggercommand\";\nimport { createBehaviorTriggerElement } from \"./utils\";\n\nimport \"../theme/behaviortrigger.scss\";\n\nconst HIGHLIGHT_CLASS = \"ck-behaviortrigger_selected\";\n\n/**\n * The behavior trigger engine feature.\n *\n * It introduces the `behaviorTrigger=\"id\"` attribute in the model which renders to the view as a `<a data-behavior-trigger=\"id\">` element\n * as well as `'addBehaviorTrigger'` and `'removeBehaviorTrigger'` commands.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class BehaviorTriggerEditing extends Plugin {\n  /**\n   * @inheritDoc\n   */\n  static get pluginName() {\n    return \"BehaviorTriggerEditing\";\n  }\n\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    // Clipboard is required for handling cut and paste events while typing over the link.\n    return [TwoStepCaretMovement, Input, ClipboardPipeline];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  init() {\n    const editor = this.editor;\n\n    // Allow link attribute on all inline nodes.\n    editor.model.schema.extend(\"$text\", { allowAttributes: \"behaviorTrigger\" });\n\n    editor.conversion.for(\"dataDowncast\").attributeToElement({\n      model: \"behaviorTrigger\",\n      view: createBehaviorTriggerElement,\n    });\n\n    editor.conversion.for(\"editingDowncast\").attributeToElement({\n      model: \"behaviorTrigger\",\n      view: (id, conversionApi) => {\n        return createBehaviorTriggerElement(id, conversionApi);\n      },\n    });\n\n    editor.conversion.for(\"upcast\").elementToAttribute({\n      view: {\n        name: \"a\",\n        attributes: {\n          \"data-behavior-trigger\": true,\n        },\n      },\n      model: {\n        key: \"behaviorTrigger\",\n        value: (viewElement) =>\n          viewElement.getAttribute(\"data-behavior-trigger\"),\n      },\n    });\n\n    // Create commands.\n    editor.commands.add(\n      \"addBehaviorTrigger\",\n      new AddBehaviorTriggerCommand(editor)\n    );\n    editor.commands.add(\n      \"removeBehaviorTrigger\",\n      new RemoveBehaviorTriggerCommand(editor)\n    );\n\n    // Enable two-step caret movement for `behaviorTrigger` attribute.\n    const twoStepCaretMovementPlugin = editor.plugins.get(TwoStepCaretMovement);\n    twoStepCaretMovementPlugin.registerAttribute(\"behaviorTrigger\");\n\n    // Setup highlight over selected link.\n    inlineHighlight(editor, \"behaviorTrigger\", \"a\", HIGHLIGHT_CLASS);\n\n    // Change the attributes of the selection in certain situations after the trigger was inserted into the document.\n    this._enableInsertContentSelectionAttributesFixer();\n\n    // Handle a click at the beginning/end of a trigger element.\n    this._enableClickingAfterLink();\n\n    // Handle typing over the trigger.\n    this._enableTypingOverLink();\n\n    // Handle removing the content after the trigger element.\n    this._handleDeleteContentAfterLink();\n  }\n\n  /**\n   * Starts listening to {@link module:engine/model/model~Model#event:insertContent} and corrects the model\n   * selection attributes if the selection is at the end of a trigger after inserting the content.\n   *\n   * The purpose of this action is to improve the overall UX because the user is no longer \"trapped\" by the\n   * `behaviorTrigger` attribute of the selection and they can type a \"clean\" (`behaviorTrigger`–less) text right away.\n   *\n   * See https://github.com/ckeditor/ckeditor5/issues/6053.\n   *\n   * @private\n   */\n  _enableInsertContentSelectionAttributesFixer() {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n\n    this.listenTo(\n      model,\n      \"insertContent\",\n      () => {\n        const nodeBefore = selection.anchor.nodeBefore;\n        const nodeAfter = selection.anchor.nodeAfter;\n\n        // NOTE: ↰ and ↱ represent the gravity of the selection.\n\n        // The only truly valid case is:\n        //\n        //\t\t                                 ↰\n        //\t\t...<$text behaviorTrigger=\"foo\">INSERTED[]</$text>\n        //\n        // If the selection is not \"trapped\" by the `behaviorTrigger` attribute after inserting, there's nothing\n        // to fix there.\n        if (!selection.hasAttribute(\"behaviorTrigger\")) {\n          return;\n        }\n\n        // Filter out the following case where a trigger with the same id (e.g. <a data-behavior-trigger=\"foo\">INSERTED</a>) is inserted\n        // in the middle of an existing link:\n        //\n        // Before insertion:\n        //\t\t                       ↰\n        //\t\t<$text behaviorTrigger=\"foo\">l[]ink</$text>\n        //\n        // Expected after insertion:\n        //\t\t                               ↰\n        //\t\t<$text behaviorTrigger=\"foo\">lINSERTED[]ink</$text>\n        //\n        if (!nodeBefore) {\n          return;\n        }\n\n        // Filter out the following case where the selection has the \"behaviorTrigger\" attribute because the\n        // gravity is overridden and some text with another attribute (e.g. <b>INSERTED</b>) is inserted:\n        //\n        // Before insertion:\n        //\n        //\t\t                       ↱\n        //\t\t<$text behaviorTrigger=\"foo\">[]link</$text>\n        //\n        // Expected after insertion:\n        //\n        //\t\t                                                          ↱\n        //\t\t<$text bold=\"true\">INSERTED</$text><$text behaviorTrigger=\"foo\">[]link</$text>\n        //\n        if (!nodeBefore.hasAttribute(\"behaviorTrigger\")) {\n          return;\n        }\n\n        // Filter out the following case where a link is a inserted in the middle (or before) another link\n        // (different URLs, so they will not merge). In this (let's say weird) case, we can leave the selection\n        // attributes as they are because the user will end up writing in one link or another anyway.\n        //\n        // Before insertion:\n        //\n        //\t\t                       ↰\n        //\t\t<$text behaviorTrigger=\"foo\">l[]ink</$text>\n        //\n        // Expected after insertion:\n        //\n        //\t\t                                                             ↰\n        //\t\t<$text behaviorTrigger=\"foo\">l</$text><$text behaviorTrigger=\"bar\">INSERTED[]</$text><$text behaviorTrigger=\"foo\">ink</$text>\n        //\n        if (nodeAfter && nodeAfter.hasAttribute(\"behaviorTrigger\")) {\n          return;\n        }\n\n        model.change((writer) => {\n          removeLinkAttributesFromSelection(\n            writer,\n            getLinkAttributesAllowedOnText(model.schema)\n          );\n        });\n      },\n      { priority: \"low\" }\n    );\n  }\n\n  /**\n   * Starts listening to {@link module:engine/view/document~Document#event:mousedown} and\n   * {@link module:engine/view/document~Document#event:selectionChange} and puts the selection before/after a link node\n   * if clicked at the beginning/ending of the link.\n   *\n   * The purpose of this action is to allow typing around the link node directly after a click.\n   *\n   * See https://github.com/ckeditor/ckeditor5/issues/1016.\n   *\n   * @private\n   */\n  _enableClickingAfterLink() {\n    const editor = this.editor;\n    const model = editor.model;\n\n    editor.editing.view.addObserver(MouseObserver);\n\n    let clicked = false;\n\n    // Detect the click.\n    this.listenTo(editor.editing.view.document, \"mousedown\", () => {\n      clicked = true;\n    });\n\n    // When the selection has changed...\n    this.listenTo(editor.editing.view.document, \"selectionChange\", () => {\n      if (!clicked) {\n        return;\n      }\n\n      // ...and it was caused by the click...\n      clicked = false;\n\n      const selection = model.document.selection;\n\n      // ...and no text is selected...\n      if (!selection.isCollapsed) {\n        return;\n      }\n\n      // ...and clicked text is the link...\n      if (!selection.hasAttribute(\"behaviorTrigger\")) {\n        return;\n      }\n\n      const position = selection.getFirstPosition();\n      const linkRange = findAttributeRange(\n        position,\n        \"behaviorTrigger\",\n        selection.getAttribute(\"behaviorTrigger\"),\n        model\n      );\n\n      // ...check whether clicked start/end boundary of the link.\n      // If so, remove the `behaviorTrigger` attribute.\n      if (\n        position.isTouching(linkRange.start) ||\n        position.isTouching(linkRange.end)\n      ) {\n        model.change((writer) => {\n          removeLinkAttributesFromSelection(\n            writer,\n            getLinkAttributesAllowedOnText(model.schema)\n          );\n        });\n      }\n    });\n  }\n\n  /**\n   * Starts listening to {@link module:engine/model/model~Model#deleteContent} and {@link module:engine/model/model~Model#insertContent}\n   * and checks whether typing over the link. If so, attributes of removed text are preserved and applied to the inserted text.\n   *\n   * The purpose of this action is to allow modifying a text without loosing the `behaviorTrigger` attribute (and other).\n   *\n   * See https://github.com/ckeditor/ckeditor5/issues/4762.\n   *\n   * @private\n   */\n  _enableTypingOverLink() {\n    const editor = this.editor;\n    const view = editor.editing.view;\n\n    // Selection attributes when started typing over the link.\n    let selectionAttributes;\n\n    // Whether pressed `Backspace` or `Delete`. If so, attributes should not be preserved.\n    let deletedContent;\n\n    // Detect pressing `Backspace` / `Delete`.\n    this.listenTo(\n      view.document,\n      \"delete\",\n      () => {\n        deletedContent = true;\n      },\n      { priority: \"high\" }\n    );\n\n    // Listening to `model#deleteContent` allows detecting whether selected content was a link.\n    // If so, before removing the element, we will copy its attributes.\n    this.listenTo(\n      editor.model,\n      \"deleteContent\",\n      () => {\n        const selection = editor.model.document.selection;\n\n        // Copy attributes only if anything is selected.\n        if (selection.isCollapsed) {\n          return;\n        }\n\n        // When the content was deleted, do not preserve attributes.\n        if (deletedContent) {\n          deletedContent = false;\n\n          return;\n        }\n\n        // Enabled only when typing.\n        if (!isTyping(editor)) {\n          return;\n        }\n\n        if (shouldCopyAttributes(editor.model)) {\n          selectionAttributes = selection.getAttributes();\n        }\n      },\n      { priority: \"high\" }\n    );\n\n    // Listening to `model#insertContent` allows detecting the content insertion.\n    // We want to apply attributes that were removed while typing over the link.\n    this.listenTo(\n      editor.model,\n      \"insertContent\",\n      (evt, [element]) => {\n        deletedContent = false;\n\n        // Enabled only when typing.\n        if (!isTyping(editor)) {\n          return;\n        }\n\n        if (!selectionAttributes) {\n          return;\n        }\n\n        editor.model.change((writer) => {\n          for (const [attribute, value] of selectionAttributes) {\n            writer.setAttribute(attribute, value, element);\n          }\n        });\n\n        selectionAttributes = null;\n      },\n      { priority: \"high\" }\n    );\n  }\n\n  /**\n   * Starts listening to {@link module:engine/model/model~Model#deleteContent} and checks whether\n   * removing a content right after the \"behaviorTrigger\" attribute.\n   *\n   * If so, the selection should not preserve the `behaviorTrigger` attribute. However, if\n   * the {@link module:typing/twostepcaretmovement~TwoStepCaretMovement} plugin is active and\n   * the selection has the \"behaviorTrigger\" attribute due to overriden gravity (at the end), the `behaviorTrigger` attribute should stay untouched.\n   *\n   * The purpose of this action is to allow removing the link text and keep the selection outside the link.\n   *\n   * See https://github.com/ckeditor/ckeditor5/issues/7521.\n   *\n   * @private\n   */\n  _handleDeleteContentAfterLink() {\n    const editor = this.editor;\n    const model = editor.model;\n    const selection = model.document.selection;\n    const view = editor.editing.view;\n\n    // A flag whether attributes `behaviorTrigger` attribute should be preserved.\n    let shouldPreserveAttributes = false;\n\n    // A flag whether the `Backspace` key was pressed.\n    let hasBackspacePressed = false;\n\n    // Detect pressing `Backspace`.\n    this.listenTo(\n      view.document,\n      \"delete\",\n      (evt, data) => {\n        hasBackspacePressed = data.domEvent.keyCode === keyCodes.backspace;\n      },\n      { priority: \"high\" }\n    );\n\n    // Before removing the content, check whether the selection is inside a link or at the end of link but with 2-SCM enabled.\n    // If so, we want to preserve link attributes.\n    this.listenTo(\n      model,\n      \"deleteContent\",\n      () => {\n        // Reset the state.\n        shouldPreserveAttributes = false;\n\n        const position = selection.getFirstPosition();\n        const behaviorTrigger = selection.getAttribute(\"behaviorTrigger\");\n\n        if (!behaviorTrigger) {\n          return;\n        }\n\n        const linkRange = findAttributeRange(\n          position,\n          \"behaviorTrigger\",\n          behaviorTrigger,\n          model\n        );\n\n        // Preserve `behaviorTrigger` attribute if the selection is in the middle of the link or\n        // the selection is at the end of the link and 2-SCM is activated.\n        shouldPreserveAttributes =\n          linkRange.containsPosition(position) ||\n          linkRange.end.isEqual(position);\n      },\n      { priority: \"high\" }\n    );\n\n    // After removing the content, check whether the current selection should preserve the `behaviorTrigger` attribute.\n    this.listenTo(\n      model,\n      \"deleteContent\",\n      () => {\n        // If didn't press `Backspace`.\n        if (!hasBackspacePressed) {\n          return;\n        }\n\n        hasBackspacePressed = false;\n\n        // Disable the mechanism if inside a link (`<$text url=\"foo\">F[]oo</$text>` or <$text url=\"foo\">Foo[]</$text>`).\n        if (shouldPreserveAttributes) {\n          return;\n        }\n\n        // Use `model.enqueueChange()` in order to execute the callback at the end of the changes process.\n        editor.model.enqueueChange((writer) => {\n          removeLinkAttributesFromSelection(\n            writer,\n            getLinkAttributesAllowedOnText(model.schema)\n          );\n        });\n      },\n      { priority: \"low\" }\n    );\n  }\n}\n\n// Make the selection free of link-related model attributes.\n// All link-related model attributes start with \"link\". That includes not only \"behaviorTrigger\"\n// but also all decorator attributes (they have dynamic names), or even custom plugins.\n//\n// @param {module:engine/model/writer~Writer} writer\n// @param {Array.<String>} linkAttributes\nfunction removeLinkAttributesFromSelection(writer, linkAttributes) {\n  writer.removeSelectionAttribute(\"behaviorTrigger\");\n\n  for (const attribute of linkAttributes) {\n    writer.removeSelectionAttribute(attribute);\n  }\n}\n\n// Checks whether selection's attributes should be copied to the new inserted text.\n//\n// @param {module:engine/model/model~Model} model\n// @returns {Boolean}\nfunction shouldCopyAttributes(model) {\n  const selection = model.document.selection;\n  const firstPosition = selection.getFirstPosition();\n  const lastPosition = selection.getLastPosition();\n  const nodeAtFirstPosition = firstPosition.nodeAfter;\n\n  // The text link node does not exist...\n  if (!nodeAtFirstPosition) {\n    return false;\n  }\n\n  // ...or it isn't the text node...\n  if (!nodeAtFirstPosition.is(\"$text\")) {\n    return false;\n  }\n\n  // ...or isn't the link.\n  if (!nodeAtFirstPosition.hasAttribute(\"behaviorTrigger\")) {\n    return false;\n  }\n\n  // `textNode` = the position is inside the link element.\n  // `nodeBefore` = the position is at the end of the link element.\n  const nodeAtLastPosition = lastPosition.textNode || lastPosition.nodeBefore;\n\n  // If both references the same node selection contains a single text node.\n  if (nodeAtFirstPosition === nodeAtLastPosition) {\n    return true;\n  }\n\n  // If nodes are not equal, maybe the link nodes has defined additional attributes inside.\n  // First, we need to find the entire link range.\n  const linkRange = findAttributeRange(\n    firstPosition,\n    \"behaviorTrigger\",\n    nodeAtFirstPosition.getAttribute(\"behaviorTrigger\"),\n    model\n  );\n\n  // Then we can check whether selected range is inside the found link range. If so, attributes should be preserved.\n  return linkRange.containsRange(\n    model.createRange(firstPosition, lastPosition),\n    true\n  );\n}\n\n// Checks whether provided changes were caused by typing.\n//\n// @params {module:core/editor/editor~Editor} editor\n// @returns {Boolean}\nfunction isTyping(editor) {\n  const currentBatch = editor.model.change((writer) => writer.batch);\n\n  return currentBatch.isTyping;\n}\n\n// Returns an array containing names of the attributes allowed on `$text` that describes the link item.\n//\n// @param {module:engine/model/schema~Schema} schema\n// @returns {Array.<String>}\nfunction getLinkAttributesAllowedOnText(schema) {\n  const textAttributes = schema.getDefinition(\"$text\").allowAttributes;\n\n  return textAttributes.filter((attribute) =>\n    attribute.startsWith(\"behaviorTrigger\")\n  );\n}\n","import {\n  ButtonView,\n  FocusCycler,\n  LabeledFieldView,\n  SwitchButtonView,\n  View,\n  ViewCollection,\n  createLabeledInputText,\n  submitHandler,\n} from \"@ckeditor/ckeditor5-ui\";\nimport { FocusTracker, KeystrokeHandler } from \"@ckeditor/ckeditor5-utils\";\nimport { icons } from \"@ckeditor/ckeditor5-core\";\n\nimport \"@ckeditor/ckeditor5-ui/theme/components/responsive-form/responsiveform.css\";\nimport \"../../theme/behaviortriggerform.scss\";\n\n/**\n * The link form view controller class.\n *\n * See {@link module:link/ui/linkformview~LinkFormView}.\n *\n * @extends module:ui/view~View\n */\nexport default class BehaviorTriggerFormView extends View {\n  /**\n   * Creates an instance of the {@link module:link/ui/linkformview~LinkFormView} class.\n   *\n   * Also see {@link #render}.\n   *\n   * @param {module:utils/locale~Locale} [locale] The localization services instance.\n   * @param {module:link/linkcommand~LinkCommand} linkCommand Reference to {@link module:link/linkcommand~LinkCommand}.\n   * @param {String} [protocol] A value of a protocol to be displayed in the input's placeholder.\n   */\n  constructor(locale, addBehaviorTriggerCommand) {\n    super(locale);\n\n    const t = locale.t;\n\n    /**\n     * Tracks information about DOM focus in the form.\n     *\n     * @readonly\n     * @member {module:utils/focustracker~FocusTracker}\n     */\n    this.focusTracker = new FocusTracker();\n\n    /**\n     * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n     *\n     * @readonly\n     * @member {module:utils/keystrokehandler~KeystrokeHandler}\n     */\n    this.keystrokes = new KeystrokeHandler();\n\n    /**\n     * The id input view.\n     *\n     * @member {module:ui/labeledfield/labeledfieldview~LabeledFieldView}\n     */\n    this.idInputView = this._createIdInput();\n\n    /**\n     * The Save button view.\n     *\n     * @member {module:ui/button/buttonview~ButtonView}\n     */\n    this.saveButtonView = this._createButton(\n      t(\"Save\"),\n      icons.check,\n      \"ck-button-save\"\n    );\n    this.saveButtonView.type = \"submit\";\n\n    /**\n     * The Cancel button view.\n     *\n     * @member {module:ui/button/buttonview~ButtonView}\n     */\n    this.cancelButtonView = this._createButton(\n      t(\"Cancel\"),\n      icons.cancel,\n      \"ck-button-cancel\",\n      \"cancel\"\n    );\n\n    /**\n     * A collection of {@link module:ui/button/switchbuttonview~SwitchButtonView},\n     * which corresponds to {@link module:link/linkcommand~LinkCommand#manualDecorators manual decorators}\n     * configured in the editor.\n     *\n     * @private\n     * @readonly\n     * @type {module:ui/viewcollection~ViewCollection}\n     */\n    this._manualDecoratorSwitches = this._createManualDecoratorSwitches(\n      addBehaviorTriggerCommand\n    );\n\n    /**\n     * A collection of child views in the form.\n     *\n     * @readonly\n     * @type {module:ui/viewcollection~ViewCollection}\n     */\n    this.children = this._createFormChildren(\n      addBehaviorTriggerCommand.manualDecorators\n    );\n\n    /**\n     * A collection of views that can be focused in the form.\n     *\n     * @readonly\n     * @protected\n     * @member {module:ui/viewcollection~ViewCollection}\n     */\n    this._focusables = new ViewCollection();\n\n    /**\n     * Helps cycling over {@link #_focusables} in the form.\n     *\n     * @readonly\n     * @protected\n     * @member {module:ui/focuscycler~FocusCycler}\n     */\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate form fields backwards using the Shift + Tab keystroke.\n        focusPrevious: \"shift + tab\",\n\n        // Navigate form fields forwards using the Tab key.\n        focusNext: \"tab\",\n      },\n    });\n\n    const classList = [\"ck\", \"ck-behaviortrigger-form\", \"ck-responsive-form\"];\n\n    if (addBehaviorTriggerCommand.manualDecorators.length) {\n      classList.push(\n        \"ck-behaviortrigger-form_layout-vertical\",\n        \"ck-vertical-form\"\n      );\n    }\n\n    this.setTemplate({\n      tag: \"form\",\n\n      attributes: {\n        class: classList,\n\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: \"-1\",\n      },\n\n      children: this.children,\n    });\n  }\n\n  /**\n   * Obtains the state of the {@link module:ui/button/switchbuttonview~SwitchButtonView switch buttons} representing\n   * {@link module:link/linkcommand~LinkCommand#manualDecorators manual link decorators}\n   * in the {@link module:link/ui/linkformview~LinkFormView}.\n   *\n   * @returns {Object.<String,Boolean>} Key-value pairs, where the key is the name of the decorator and the value is\n   * its state.\n   */\n  getDecoratorSwitchesState() {\n    return Array.from(this._manualDecoratorSwitches).reduce(\n      (accumulator, switchButton) => {\n        accumulator[switchButton.name] = switchButton.isOn;\n        return accumulator;\n      },\n      {}\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  render() {\n    super.render();\n\n    submitHandler({\n      view: this,\n    });\n\n    const childViews = [\n      this.idInputView,\n      ...this._manualDecoratorSwitches,\n      this.saveButtonView,\n      this.cancelButtonView,\n    ];\n\n    childViews.forEach((v) => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroy() {\n    super.destroy();\n\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n\n  /**\n   * Focuses the fist {@link #_focusables} in the form.\n   */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n\n  /**\n   * Creates a labeled input view.\n   *\n   * @private\n   * @returns {module:ui/labeledfield/labeledfieldview~LabeledFieldView} Labeled field view instance.\n   */\n  _createIdInput() {\n    const t = this.locale.t;\n    const labeledInput = new LabeledFieldView(\n      this.locale,\n      createLabeledInputText\n    );\n\n    labeledInput.label = t(\"Trigger ID\");\n\n    return labeledInput;\n  }\n\n  /**\n   * Creates a button view.\n   *\n   * @private\n   * @param {String} label The button label.\n   * @param {String} icon The button icon.\n   * @param {String} className The additional button CSS class name.\n   * @param {String} [eventName] An event name that the `ButtonView#execute` event will be delegated to.\n   * @returns {module:ui/button/buttonview~ButtonView} The button view instance.\n   */\n  _createButton(label, icon, className, eventName) {\n    const button = new ButtonView(this.locale);\n\n    button.set({\n      label,\n      icon,\n      tooltip: true,\n    });\n\n    button.extendTemplate({\n      attributes: {\n        class: className,\n      },\n    });\n\n    if (eventName) {\n      button.delegate(\"execute\").to(this, eventName);\n    }\n\n    return button;\n  }\n\n  /**\n   * Populates {@link module:ui/viewcollection~ViewCollection} of {@link module:ui/button/switchbuttonview~SwitchButtonView}\n   * made based on {@link module:link/linkcommand~LinkCommand#manualDecorators}.\n   *\n   * @private\n   * @param {module:link/linkcommand~LinkCommand} linkCommand A reference to the link command.\n   * @returns {module:ui/viewcollection~ViewCollection} of switch buttons.\n   */\n  _createManualDecoratorSwitches(addBehaviorTriggerCommand) {\n    const switches = this.createCollection();\n\n    for (const manualDecorator of addBehaviorTriggerCommand.manualDecorators) {\n      const switchButton = new SwitchButtonView(this.locale);\n\n      switchButton.set({\n        name: manualDecorator.id,\n        label: manualDecorator.label,\n        withText: true,\n      });\n\n      switchButton\n        .bind(\"isOn\")\n        .toMany(\n          [manualDecorator, addBehaviorTriggerCommand],\n          \"value\",\n          (decoratorValue, commandValue) => {\n            return commandValue === undefined && decoratorValue === undefined\n              ? manualDecorator.defaultValue\n              : decoratorValue;\n          }\n        );\n\n      switchButton.on(\"execute\", () => {\n        manualDecorator.set(\"value\", !switchButton.isOn);\n      });\n\n      switches.add(switchButton);\n    }\n\n    return switches;\n  }\n\n  /**\n   * Populates the {@link #children} collection of the form.\n   *\n   * If {@link module:link/linkcommand~LinkCommand#manualDecorators manual decorators} are configured in the editor, it creates an\n   * additional `View` wrapping all {@link #_manualDecoratorSwitches} switch buttons corresponding\n   * to these decorators.\n   *\n   * @private\n   * @param {module:utils/collection~Collection} manualDecorators A reference to\n   * the collection of manual decorators stored in the link command.\n   * @returns {module:ui/viewcollection~ViewCollection} The children of link form view.\n   */\n  _createFormChildren(manualDecorators) {\n    const children = this.createCollection();\n\n    children.add(this.idInputView);\n\n    if (manualDecorators.length) {\n      const additionalButtonsView = new View();\n\n      additionalButtonsView.setTemplate({\n        tag: \"ul\",\n        children: this._manualDecoratorSwitches.map((switchButton) => ({\n          tag: \"li\",\n          children: [switchButton],\n          attributes: {\n            class: [\"ck\", \"ck-list__item\"],\n          },\n        })),\n        attributes: {\n          class: [\"ck\", \"ck-reset\", \"ck-list\"],\n        },\n      });\n      children.add(additionalButtonsView);\n    }\n\n    children.add(this.saveButtonView);\n    children.add(this.cancelButtonView);\n\n    return children;\n  }\n}\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xml:space=\\\"preserve\\\" viewBox=\\\"0 0 22 22\\\">\\n  <path d=\\\"m15.34 1.768-4.506 7.721 5.661.797v.329L6.687 20.26l-.028-.029 4.641-8.105-5.795-.852v-.329l9.782-9.205zM19.035 19.465 17.48 21.02a.824.824 0 1 1-1.207-1.125l.041-.041 1.555-1.557-1.557-1.555a.824.824 0 0 1 1.166-1.166l1.556 1.555 1.557-1.557a.825.825 0 1 1 1.166 1.168l-1.555 1.555 1.555 1.557a.824.824 0 1 1-1.166 1.166l-1.556-1.555z\\\"/>\\n</svg>\\n\";","import {\n  ButtonView,\n  LabelView,\n  View,\n  ViewCollection,\n  FocusCycler,\n} from \"@ckeditor/ckeditor5-ui\";\nimport { FocusTracker, KeystrokeHandler } from \"@ckeditor/ckeditor5-utils\";\nimport { icons } from \"@ckeditor/ckeditor5-core\";\n\nimport \"@ckeditor/ckeditor5-ui/theme/components/responsive-form/responsiveform.css\";\nimport \"../../theme/behaviortriggeractions.scss\";\n\nimport removeBehaviorTriggerIcon from \"../../theme/icons/removebehaviortrigger.svg\";\n\n/**\n * The link actions view class. This view displays the link preview, allows\n * unlinking or editing the link.\n *\n * @extends module:ui/view~View\n */\nexport default class BehaviorTriggerActionsView extends View {\n  /**\n   * @inheritDoc\n   */\n  constructor(locale) {\n    super(locale);\n\n    const t = locale.t;\n\n    /**\n     * Tracks information about DOM focus in the actions.\n     *\n     * @readonly\n     * @member {module:utils/focustracker~FocusTracker}\n     */\n    this.focusTracker = new FocusTracker();\n\n    /**\n     * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n     *\n     * @readonly\n     * @member {module:utils/keystrokehandler~KeystrokeHandler}\n     */\n    this.keystrokes = new KeystrokeHandler();\n\n    /**\n     * The id preview view.\n     *\n     * @member {module:ui/view~View}\n     */\n    this.previewLabelView = this._createPreviewLabel();\n\n    /**\n     * The unlink button view.\n     *\n     * @member {module:ui/button/buttonview~ButtonView}\n     */\n    this.removeTriggerButtonView = this._createButton(\n      t(\"Remove\"),\n      removeBehaviorTriggerIcon,\n      \"removeBehaviorTrigger\"\n    );\n\n    /**\n     * The edit link button view.\n     *\n     * @member {module:ui/button/buttonview~ButtonView}\n     */\n    this.editButtonView = this._createButton(t(\"Edit\"), icons.pencil, \"edit\");\n\n    /**\n     * The value of the trigger \"id\" attribute of use in the {@link #previewLabelView}.\n     *\n     * @observable\n     * @member {String}\n     */\n    this.set(\"id\");\n\n    /**\n     * A collection of views that can be focused in the view.\n     *\n     * @readonly\n     * @protected\n     * @member {module:ui/viewcollection~ViewCollection}\n     */\n    this._focusables = new ViewCollection();\n\n    /**\n     * Helps cycling over {@link #_focusables} in the view.\n     *\n     * @readonly\n     * @protected\n     * @member {module:ui/focuscycler~FocusCycler}\n     */\n    this._focusCycler = new FocusCycler({\n      focusables: this._focusables,\n      focusTracker: this.focusTracker,\n      keystrokeHandler: this.keystrokes,\n      actions: {\n        // Navigate fields backwards using the Shift + Tab keystroke.\n        focusPrevious: \"shift + tab\",\n\n        // Navigate fields forwards using the Tab key.\n        focusNext: \"tab\",\n      },\n    });\n\n    this.setTemplate({\n      tag: \"div\",\n\n      attributes: {\n        class: [\"ck\", \"ck-behaviortrigger-actions\", \"ck-responsive-form\"],\n\n        // https://github.com/ckeditor/ckeditor5-link/issues/90\n        tabindex: \"-1\",\n      },\n\n      children: [\n        this.previewLabelView,\n        this.editButtonView,\n        this.removeTriggerButtonView,\n      ],\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  render() {\n    super.render();\n\n    const childViews = [\n      this.previewLabelView,\n      this.editButtonView,\n      this.removeTriggerButtonView,\n    ];\n\n    childViews.forEach((v) => {\n      // Register the view as focusable.\n      this._focusables.add(v);\n\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n\n    // Start listening for the keystrokes coming from #element.\n    this.keystrokes.listenTo(this.element);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroy() {\n    super.destroy();\n\n    this.focusTracker.destroy();\n    this.keystrokes.destroy();\n  }\n\n  /**\n   * Focuses the fist {@link #_focusables} in the actions.\n   */\n  focus() {\n    this._focusCycler.focusFirst();\n  }\n\n  /**\n   * Creates a button view.\n   *\n   * @private\n   * @param {String} label The button label.\n   * @param {String} icon The button icon.\n   * @param {String} [eventName] An event name that the `ButtonView#execute` event will be delegated to.\n   * @returns {module:ui/button/buttonview~ButtonView} The button view instance.\n   */\n  _createButton(label, icon, eventName) {\n    const button = new ButtonView(this.locale);\n\n    button.set({\n      label,\n      icon,\n      tooltip: true,\n    });\n\n    button.delegate(\"execute\").to(this, eventName);\n\n    return button;\n  }\n\n  /**\n   * Creates a trigger id preview label.\n   *\n   * @private\n   * @returns {module:ui/label/labelview~LabelView} The label view instance.\n   */\n  _createPreviewLabel() {\n    const label = new LabelView(this.locale);\n    const t = this.t;\n\n    label.extendTemplate({\n      attributes: {\n        class: [\"ck\", \"ck-behaviortrigger-actions__preview\"],\n      },\n    });\n\n    label.bind(\"text\").to(this, \"id\", (id) => {\n      return id || t(\"This trigger has no ID\");\n    });\n\n    return label;\n  }\n}\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xml:space=\\\"preserve\\\" viewBox=\\\"0 0 22 22\\\">\\n  <path d=\\\"m15.34 1.768-4.506 7.721 5.661.797v.329L6.687 20.26l-.028-.029 4.641-8.105-5.795-.852v-.329l9.782-9.205z\\\"/>\\n</svg>\\n\";","import { Plugin } from \"@ckeditor/ckeditor5-core\";\nimport { ClickObserver } from \"@ckeditor/ckeditor5-engine\";\nimport {\n  ButtonView,\n  ContextualBalloon,\n  clickOutsideHandler,\n  CssTransitionDisablerMixin,\n} from \"@ckeditor/ckeditor5-ui\";\nimport { isWidget } from \"@ckeditor/ckeditor5-widget\";\nimport viewToPlainText from \"@ckeditor/ckeditor5-clipboard/src/utils/viewtoplaintext\";\n\nimport BehaviorTriggerFormView from \"./ui/behaviortriggerformview\";\nimport BehaviorTriggerActionsView from \"./ui/behaviortriggeractionsview\";\nimport { isLinkElement, TRIGGER_KEYSTROKE } from \"./utils\";\n\nimport addBehaviorTriggerIcon from \"../theme/icons/addbehaviortrigger.svg\";\n\nconst VISUAL_SELECTION_MARKER_NAME = \"behaviortrigger-ui\";\n\n/**\n * The behavior trigger UI plugin. It introduces the `'addbehaviortrigger'` and `'removebehaviortrigger'` buttons and support for the <kbd>Ctrl+T</kbd> keystroke.\n *\n * It uses the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon plugin}.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class BehaviorTriggerUI extends Plugin {\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [ContextualBalloon];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  static get pluginName() {\n    return \"BehaviorTriggerUI\";\n  }\n\n  /**\n   * @inheritDoc\n   */\n  init() {\n    const editor = this.editor;\n\n    editor.editing.view.addObserver(ClickObserver);\n\n    /**\n     * The actions view displayed inside of the balloon.\n     *\n     * @member {module:link/ui/BehaviorTriggerActionsView~BehaviorTriggerActionsView}\n     */\n    this.actionsView = this._createActionsView();\n\n    /**\n     * The form view displayed inside the balloon.\n     *\n     * @member {module:link/ui/BehaviorTriggerFormView~BehaviorTriggerFormView}\n     */\n    this.formView = this._createFormView();\n\n    /**\n     * The contextual balloon plugin instance.\n     *\n     * @private\n     * @member {module:ui/panel/balloon/contextualballoon~ContextualBalloon}\n     */\n    this._balloon = editor.plugins.get(ContextualBalloon);\n\n    // Create toolbar buttons.\n    this._createToolbarAddButton();\n\n    // Attach lifecycle actions to the the balloon.\n    this._enableUserBalloonInteractions();\n\n    // Renders a fake visual selection marker on an expanded selection.\n    editor.conversion.for(\"editingDowncast\").markerToHighlight({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: {\n        classes: [\"ck-fake-behaviortrigger-selection\"],\n      },\n    });\n\n    // Renders a fake visual selection marker on a collapsed selection.\n    editor.conversion.for(\"editingDowncast\").markerToElement({\n      model: VISUAL_SELECTION_MARKER_NAME,\n      view: {\n        name: \"span\",\n        classes: [\n          \"ck-fake-behaviortrigger-selection\",\n          \"ck-fake-behaviortrigger-selection_collapsed\",\n        ],\n      },\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroy() {\n    super.destroy();\n\n    // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n    this.formView.destroy();\n  }\n\n  /**\n   * Creates the {@link module:link/ui/BehaviorTriggerActionsView~BehaviorTriggerActionsView} instance.\n   *\n   * @private\n   * @returns {module:link/ui/BehaviorTriggerActionsView~BehaviorTriggerActionsView} The link actions view instance.\n   */\n  _createActionsView() {\n    const editor = this.editor;\n    const actionsView = new BehaviorTriggerActionsView(editor.locale);\n    const addBehaviorTriggerCommand = editor.commands.get(\"addBehaviorTrigger\");\n    const removeBehaviorTriggerCommand = editor.commands.get(\n      \"removeBehaviorTrigger\"\n    );\n\n    actionsView.bind(\"id\").to(addBehaviorTriggerCommand, \"value\");\n    actionsView.editButtonView.bind(\"isEnabled\").to(addBehaviorTriggerCommand);\n    actionsView.removeTriggerButtonView\n      .bind(\"isEnabled\")\n      .to(removeBehaviorTriggerCommand);\n\n    // Execute removeBehaviorTrigger command after clicking on the \"Edit\" button.\n    this.listenTo(actionsView, \"edit\", () => {\n      this._addFormView();\n    });\n\n    // Execute removeBehaviorTrigger command after clicking on the \"Remove\" button.\n    this.listenTo(actionsView, \"removeBehaviorTrigger\", () => {\n      editor.execute(\"removeBehaviorTrigger\");\n      this._hideUI();\n    });\n\n    // Close the panel on esc key press when the **actions have focus**.\n    actionsView.keystrokes.set(\"Esc\", (data, cancel) => {\n      this._hideUI();\n      cancel();\n    });\n\n    // Open the form view on Ctrl+K when the **actions have focus**..\n    actionsView.keystrokes.set(TRIGGER_KEYSTROKE, (data, cancel) => {\n      this._addFormView();\n      cancel();\n    });\n\n    return actionsView;\n  }\n\n  /**\n   * Creates the {@link module:link/ui/BehaviorTriggerFormView~BehaviorTriggerFormView} instance.\n   *\n   * @private\n   * @returns {module:link/ui/BehaviorTriggerFormView~BehaviorTriggerFormView} The link form view instance.\n   */\n  _createFormView() {\n    const editor = this.editor;\n    const addBehaviorTriggerCommand = editor.commands.get(\"addBehaviorTrigger\");\n\n    const formView = new (CssTransitionDisablerMixin(BehaviorTriggerFormView))(\n      editor.locale,\n      addBehaviorTriggerCommand\n    );\n\n    formView.idInputView.fieldView\n      .bind(\"value\")\n      .to(addBehaviorTriggerCommand, \"value\");\n\n    // Form elements should be read-only when corresponding commands are disabled.\n    formView.idInputView\n      .bind(\"isReadOnly\")\n      .to(addBehaviorTriggerCommand, \"isEnabled\", (value) => !value);\n    formView.saveButtonView.bind(\"isEnabled\").to(addBehaviorTriggerCommand);\n\n    // Execute link command after clicking the \"Save\" button.\n    this.listenTo(formView, \"submit\", () => {\n      const { value } = formView.idInputView.fieldView.element;\n      editor.execute(\n        \"addBehaviorTrigger\",\n        value,\n        formView.getDecoratorSwitchesState()\n      );\n      this._closeFormView();\n    });\n\n    // Hide the panel after clicking the \"Cancel\" button.\n    this.listenTo(formView, \"cancel\", () => {\n      this._closeFormView();\n    });\n\n    // Close the panel on esc key press when the **form has focus**.\n    formView.keystrokes.set(\"Esc\", (data, cancel) => {\n      this._closeFormView();\n      cancel();\n    });\n\n    return formView;\n  }\n\n  /**\n   * Creates a toolbar Link button. Clicking this button will show\n   * a {@link #_balloon} attached to the selection.\n   *\n   * @private\n   */\n  _createToolbarAddButton() {\n    const editor = this.editor;\n    const addBehaviorTriggerCommand = editor.commands.get(\"addBehaviorTrigger\");\n    const t = editor.t;\n\n    // Handle the `Ctrl+K` keystroke and show the panel.\n    editor.keystrokes.set(TRIGGER_KEYSTROKE, (keyEvtData, cancel) => {\n      // Prevent focusing the search bar in FF, Chrome and Edge. See https://github.com/ckeditor/ckeditor5/issues/4811.\n      cancel();\n\n      if (addBehaviorTriggerCommand.isEnabled) {\n        this._showUI(true);\n      }\n    });\n\n    editor.ui.componentFactory.add(\"addBehaviorTrigger\", (locale) => {\n      const button = new ButtonView(locale);\n\n      button.label = t(\"Behavior\");\n      button.icon = addBehaviorTriggerIcon;\n      button.keystroke = TRIGGER_KEYSTROKE;\n      button.tooltip = true;\n      button.withText = true;\n      button.isToggleable = true;\n\n      // Bind button to the command.\n      button.bind(\"isEnabled\").to(addBehaviorTriggerCommand, \"isEnabled\");\n      button\n        .bind(\"isOn\")\n        .to(addBehaviorTriggerCommand, \"value\", (value) => !!value);\n\n      // Show the panel on button click.\n      this.listenTo(button, \"execute\", () => this._showUI(true));\n\n      return button;\n    });\n  }\n\n  /**\n   * Attaches actions that control whether the balloon panel containing the\n   * {@link #formView} is visible or not.\n   *\n   * @private\n   */\n  _enableUserBalloonInteractions() {\n    const viewDocument = this.editor.editing.view.document;\n\n    // Handle click on view document and show panel when selection is placed inside the link element.\n    // Keep panel open until selection will be inside the same link element.\n    this.listenTo(viewDocument, \"click\", () => {\n      const parentLink = this._getSelectedLinkElement();\n\n      if (parentLink) {\n        // Then show panel but keep focus inside editor editable.\n        this._showUI();\n      }\n    });\n\n    // Focus the form if the balloon is visible and the Tab key has been pressed.\n    this.editor.keystrokes.set(\n      \"Tab\",\n      (data, cancel) => {\n        if (\n          this._areActionsVisible &&\n          !this.actionsView.focusTracker.isFocused\n        ) {\n          this.actionsView.focus();\n          cancel();\n        }\n      },\n      {\n        // Use the high priority because the link UI navigation is more important\n        // than other feature's actions, e.g. list indentation.\n        // https://github.com/ckeditor/ckeditor5-link/issues/146\n        priority: \"high\",\n      }\n    );\n\n    // Close the panel on the Esc key press when the editable has focus and the balloon is visible.\n    this.editor.keystrokes.set(\"Esc\", (data, cancel) => {\n      if (this._isUIVisible) {\n        this._hideUI();\n        cancel();\n      }\n    });\n\n    // Close on click outside of balloon panel element.\n    clickOutsideHandler({\n      emitter: this.formView,\n      activator: () => this._isUIInPanel,\n      contextElements: [this._balloon.view.element],\n      callback: () => this._hideUI(),\n    });\n  }\n\n  /**\n   * Adds the {@link #actionsView} to the {@link #_balloon}.\n   *\n   * @protected\n   */\n  _addActionsView() {\n    if (this._areActionsInPanel) {\n      return;\n    }\n\n    this._balloon.add({\n      view: this.actionsView,\n      position: this._getBalloonPositionData(),\n    });\n  }\n\n  /**\n   * Adds the {@link #formView} to the {@link #_balloon}.\n   *\n   * @protected\n   */\n  _addFormView() {\n    if (this._isFormInPanel) {\n      return;\n    }\n\n    const editor = this.editor;\n    const addBehaviorTriggerCommand = editor.commands.get(\"addBehaviorTrigger\");\n    const selection = editor.model.document.selection;\n\n    this.formView.disableCssTransitions();\n\n    this._balloon.add({\n      view: this.formView,\n      position: this._getBalloonPositionData(),\n    });\n\n    // Select input when form view is currently visible.\n    if (this._balloon.visibleView === this.formView) {\n      this.formView.idInputView.fieldView.select();\n    }\n\n    this.formView.enableCssTransitions();\n\n    // Make sure that each time the panel shows up, the URL field remains in sync with the value of\n    // the command. If the user typed in the input, then canceled the balloon (`idInputView.fieldView#value` stays\n    // unaltered) and re-opened it without changing the value of the link command (e.g. because they\n    // clicked the same link), they would see the old value instead of the actual value of the command.\n    // https://github.com/ckeditor/ckeditor5-link/issues/78\n    // https://github.com/ckeditor/ckeditor5-link/issues/123\n    this.formView.idInputView.fieldView.element.value =\n      addBehaviorTriggerCommand.value ||\n      this._generateIdFromSelection(selection);\n  }\n\n  /**\n   * Closes the form view. Decides whether the balloon should be hidden completely or if the action view should be shown. This is\n   * decided upon the link command value (which has a value if the document selection is in the link).\n   *\n   * Additionally, if any {@link module:link/link~LinkConfig#decorators} are defined in the editor configuration, the state of\n   * switch buttons responsible for manual decorator handling is restored.\n   *\n   * @private\n   */\n  _closeFormView() {\n    const addBehaviorTriggerCommand =\n      this.editor.commands.get(\"addBehaviorTrigger\");\n\n    // Restore manual decorator states to represent the current model state. This case is important to reset the switch buttons\n    // when the user cancels the editing form.\n    addBehaviorTriggerCommand.restoreManualDecoratorStates();\n\n    if (addBehaviorTriggerCommand.value !== undefined) {\n      this._removeFormView();\n    } else {\n      this._hideUI();\n    }\n  }\n\n  /**\n   * Removes the {@link #formView} from the {@link #_balloon}.\n   *\n   * @protected\n   */\n  _removeFormView() {\n    if (this._isFormInPanel) {\n      // Blur the input element before removing it from DOM to prevent issues in some browsers.\n      // See https://github.com/ckeditor/ckeditor5/issues/1501.\n      this.formView.saveButtonView.focus();\n\n      this._balloon.remove(this.formView);\n\n      // Because the form has an input which has focus, the focus must be brought back\n      // to the editor. Otherwise, it would be lost.\n      this.editor.editing.view.focus();\n\n      this._hideFakeVisualSelection();\n    }\n  }\n\n  /**\n   * Shows the correct UI type. It is either {@link #formView} or {@link #actionsView}.\n   *\n   * @param {Boolean} forceVisible\n   * @private\n   */\n  _showUI(forceVisible = false) {\n    // When there's no link under the selection, go straight to the editing UI.\n    if (!this._getSelectedLinkElement()) {\n      // Show visual selection on a text without a link when the contextual balloon is displayed.\n      // See https://github.com/ckeditor/ckeditor5/issues/4721.\n      this._showFakeVisualSelection();\n\n      this._addActionsView();\n\n      // Be sure panel with link is visible.\n      if (forceVisible) {\n        this._balloon.showStack(\"main\");\n      }\n\n      this._addFormView();\n    }\n    // If there's a link under the selection...\n    else {\n      // Go to the editing UI if actions are already visible.\n      if (this._areActionsVisible) {\n        this._addFormView();\n      }\n      // Otherwise display just the actions UI.\n      else {\n        this._addActionsView();\n      }\n\n      // Be sure panel with link is visible.\n      if (forceVisible) {\n        this._balloon.showStack(\"main\");\n      }\n    }\n\n    // Begin responding to ui#update once the UI is added.\n    this._startUpdatingUI();\n  }\n\n  /**\n   * Removes the {@link #formView} from the {@link #_balloon}.\n   *\n   * See {@link #_addFormView}, {@link #_addActionsView}.\n   *\n   * @protected\n   */\n  _hideUI() {\n    if (!this._isUIInPanel) {\n      return;\n    }\n\n    const editor = this.editor;\n\n    this.stopListening(editor.ui, \"update\");\n    this.stopListening(this._balloon, \"change:visibleView\");\n\n    // Make sure the focus always gets back to the editable _before_ removing the focused form view.\n    // Doing otherwise causes issues in some browsers. See https://github.com/ckeditor/ckeditor5-link/issues/193.\n    editor.editing.view.focus();\n\n    // Remove form first because it's on top of the stack.\n    this._removeFormView();\n\n    // Then remove the actions view because it's beneath the form.\n    this._balloon.remove(this.actionsView);\n\n    this._hideFakeVisualSelection();\n  }\n\n  /**\n   * Makes the UI react to the {@link module:core/editor/editorui~EditorUI#event:update} event to\n   * reposition itself when the editor UI should be refreshed.\n   *\n   * See: {@link #_hideUI} to learn when the UI stops reacting to the `update` event.\n   *\n   * @protected\n   */\n  _startUpdatingUI() {\n    const editor = this.editor;\n    const viewDocument = editor.editing.view.document;\n\n    let prevSelectedLink = this._getSelectedLinkElement();\n    let prevSelectionParent = getSelectionParent();\n\n    const update = () => {\n      const selectedLink = this._getSelectedLinkElement();\n      const selectionParent = getSelectionParent();\n\n      // Hide the panel if:\n      //\n      // * the selection went out of the EXISTING link element. E.g. user moved the caret out\n      //   of the link,\n      // * the selection went to a different parent when creating a NEW link. E.g. someone\n      //   else modified the document.\n      // * the selection has expanded (e.g. displaying link actions then pressing SHIFT+Right arrow).\n      //\n      // Note: #_getSelectedLinkElement will return a link for a non-collapsed selection only\n      // when fully selected.\n      if (\n        (prevSelectedLink && !selectedLink) ||\n        (!prevSelectedLink && selectionParent !== prevSelectionParent)\n      ) {\n        this._hideUI();\n      }\n      // Update the position of the panel when:\n      //  * link panel is in the visible stack\n      //  * the selection remains in the original link element,\n      //  * there was no link element in the first place, i.e. creating a new link\n      else if (this._isUIVisible) {\n        // If still in a link element, simply update the position of the balloon.\n        // If there was no link (e.g. inserting one), the balloon must be moved\n        // to the new position in the editing view (a new native DOM range).\n        this._balloon.updatePosition(this._getBalloonPositionData());\n      }\n\n      prevSelectedLink = selectedLink;\n      prevSelectionParent = selectionParent;\n    };\n\n    function getSelectionParent() {\n      return viewDocument.selection.focus\n        .getAncestors()\n        .reverse()\n        .find((node) => node.is(\"element\"));\n    }\n\n    this.listenTo(editor.ui, \"update\", update);\n    this.listenTo(this._balloon, \"change:visibleView\", update);\n  }\n\n  /**\n   * Returns `true` when {@link #formView} is in the {@link #_balloon}.\n   *\n   * @readonly\n   * @protected\n   * @type {Boolean}\n   */\n  get _isFormInPanel() {\n    return this._balloon.hasView(this.formView);\n  }\n\n  /**\n   * Returns `true` when {@link #actionsView} is in the {@link #_balloon}.\n   *\n   * @readonly\n   * @protected\n   * @type {Boolean}\n   */\n  get _areActionsInPanel() {\n    return this._balloon.hasView(this.actionsView);\n  }\n\n  /**\n   * Returns `true` when {@link #actionsView} is in the {@link #_balloon} and it is\n   * currently visible.\n   *\n   * @readonly\n   * @protected\n   * @type {Boolean}\n   */\n  get _areActionsVisible() {\n    return this._balloon.visibleView === this.actionsView;\n  }\n\n  /**\n   * Returns `true` when {@link #actionsView} or {@link #formView} is in the {@link #_balloon}.\n   *\n   * @readonly\n   * @protected\n   * @type {Boolean}\n   */\n  get _isUIInPanel() {\n    return this._isFormInPanel || this._areActionsInPanel;\n  }\n\n  /**\n   * Returns `true` when {@link #actionsView} or {@link #formView} is in the {@link #_balloon} and it is\n   * currently visible.\n   *\n   * @readonly\n   * @protected\n   * @type {Boolean}\n   */\n  get _isUIVisible() {\n    const visibleView = this._balloon.visibleView;\n\n    return visibleView == this.formView || this._areActionsVisible;\n  }\n\n  /**\n   * Returns positioning options for the {@link #_balloon}. They control the way the balloon is attached\n   * to the target element or selection.\n   *\n   * If the selection is collapsed and inside a link element, the panel will be attached to the\n   * entire link element. Otherwise, it will be attached to the selection.\n   *\n   * @private\n   * @returns {module:utils/dom/position~Options}\n   */\n  _getBalloonPositionData() {\n    const view = this.editor.editing.view;\n    const model = this.editor.model;\n    const viewDocument = view.document;\n    let target = null;\n\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      // There are cases when we highlight selection using a marker (#7705, #4721).\n      const markerViewElements = Array.from(\n        this.editor.editing.mapper.markerNameToElements(\n          VISUAL_SELECTION_MARKER_NAME\n        )\n      );\n      const newRange = view.createRange(\n        view.createPositionBefore(markerViewElements[0]),\n        view.createPositionAfter(\n          markerViewElements[markerViewElements.length - 1]\n        )\n      );\n\n      target = view.domConverter.viewRangeToDom(newRange);\n    } else {\n      // Make sure the target is calculated on demand at the last moment because a cached DOM range\n      // (which is very fragile) can desynchronize with the state of the editing view if there was\n      // any rendering done in the meantime. This can happen, for instance, when an inline widget\n      // gets unlinked.\n      target = () => {\n        const targetLink = this._getSelectedLinkElement();\n\n        return targetLink\n          ? // When selection is inside link element, then attach panel to this element.\n            view.domConverter.mapViewToDom(targetLink)\n          : // Otherwise attach panel to the selection.\n            view.domConverter.viewRangeToDom(\n              viewDocument.selection.getFirstRange()\n            );\n      };\n    }\n\n    return { target };\n  }\n\n  /**\n   * Returns the link {@link module:engine/view/attributeelement~AttributeElement} under\n   * the {@link module:engine/view/document~Document editing view's} selection or `null`\n   * if there is none.\n   *\n   * **Note**: For a non–collapsed selection, the link element is returned when **fully**\n   * selected and the **only** element within the selection boundaries, or when\n   * a linked widget is selected.\n   *\n   * @private\n   * @returns {module:engine/view/attributeelement~AttributeElement|null}\n   */\n  _getSelectedLinkElement() {\n    const view = this.editor.editing.view;\n    const selection = view.document.selection;\n    const selectedElement = selection.getSelectedElement();\n\n    // The selection is collapsed or some widget is selected (especially inline widget).\n    if (\n      selection.isCollapsed ||\n      (selectedElement && isWidget(selectedElement))\n    ) {\n      return findLinkElementAncestor(selection.getFirstPosition());\n    } else {\n      // The range for fully selected link is usually anchored in adjacent text nodes.\n      // Trim it to get closer to the actual link element.\n      const range = selection.getFirstRange().getTrimmed();\n      const startLink = findLinkElementAncestor(range.start);\n      const endLink = findLinkElementAncestor(range.end);\n\n      if (!startLink || startLink != endLink) {\n        return null;\n      }\n\n      // Check if the link element is fully selected.\n      if (view.createRangeIn(startLink).getTrimmed().isEqual(range)) {\n        return startLink;\n      } else {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Displays a fake visual selection when the contextual balloon is displayed.\n   *\n   * This adds a 'link-ui' marker into the document that is rendered as a highlight on selected text fragment.\n   *\n   * @private\n   */\n  _showFakeVisualSelection() {\n    const model = this.editor.model;\n\n    model.change((writer) => {\n      const range = model.document.selection.getFirstRange();\n\n      if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n        writer.updateMarker(VISUAL_SELECTION_MARKER_NAME, { range });\n      } else {\n        if (range.start.isAtEnd) {\n          const startPosition = range.start.getLastMatchingPosition(\n            ({ item }) => !model.schema.isContent(item),\n            { boundaries: range }\n          );\n\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range: writer.createRange(startPosition, range.end),\n          });\n        } else {\n          writer.addMarker(VISUAL_SELECTION_MARKER_NAME, {\n            usingOperation: false,\n            affectsData: false,\n            range,\n          });\n        }\n      }\n    });\n  }\n\n  /**\n   * Hides the fake visual selection created in {@link #_showFakeVisualSelection}.\n   *\n   * @private\n   */\n  _hideFakeVisualSelection() {\n    const model = this.editor.model;\n\n    if (model.markers.has(VISUAL_SELECTION_MARKER_NAME)) {\n      model.change((writer) => {\n        writer.removeMarker(VISUAL_SELECTION_MARKER_NAME);\n      });\n    }\n  }\n\n  _generateIdFromSelection(selection) {\n    let id = \"\";\n\n    // Get selection as plain text.\n    for (const range of selection.getRanges()) {\n      for (const item of range.getItems()) {\n        id += viewToPlainText(item);\n      }\n    }\n\n    // Remove special characters.\n    id = id.replace(/[«»!\"#$%&'()*+,/:;<=>?@[\\\\\\]^`{|}~]/g, \"\");\n\n    // Truncate to 10 characters.\n    id = id.substring(0, 20);\n\n    // Strip whitespaces from beginning and end.\n    id = id.trim();\n\n    // Transform to lowercase.\n    id = id.toLowerCase();\n\n    // Replace dots and spaces with a short dash.\n    id = id.replace(/(\\s|\\.)/g, \"-\");\n\n    // Replace multiple dashes with a single dash.\n    id = id.replace(/-{2,}/g, \"-\");\n\n    // Replace long dash with two short dashes.\n    id = id.replace(/—/g, \"--\");\n\n    return id;\n  }\n}\n\n// Returns a link element if there's one among the ancestors of the provided `Position`.\n//\n// @private\n// @param {module:engine/view/position~Position} View position to analyze.\n// @returns {module:engine/view/attributeelement~AttributeElement|null} Link element at the position or null.\nfunction findLinkElementAncestor(position) {\n  return position.getAncestors().find((ancestor) => isLinkElement(ancestor));\n}\n","import { Plugin } from \"@ckeditor/ckeditor5-core\";\nimport BehaviorTriggerEditing from \"./behaviortriggerediting\";\nimport BehaviorTriggerUI from \"./behaviortriggerui\";\n\nexport default class BehaviorTrigger extends Plugin {\n  static get requires() {\n    return [BehaviorTriggerEditing, BehaviorTriggerUI];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  static get pluginName() {\n    return \"BehaviorTrigger\";\n  }\n}\n","export { default as BehaviorTrigger } from \"./behaviortrigger\";\nexport { default as BehaviorTriggerEditing } from \"./behaviortriggerediting\";\nexport { default as BehaviorTriggerUI } from \"./behaviortriggerui\";\n","import { LinkCommand } from \"@ckeditor/ckeditor5-link\";\nimport { omit } from \"lodash\";\nimport { useModule } from \"@metascore-library/core/services/module-manager\";\n\nexport default class CustomLinkCommand extends LinkCommand {\n  /**\n   * @inheritDoc\n   */\n  constructor(editor) {\n    super(editor);\n\n    /**\n     * The type of link.\n     *\n     * @observable\n     * @readonly\n     * @member #type\n     */\n    this.set(\"type\", null);\n\n    /**\n     * The link parameters.\n     *\n     * @observable\n     * @readonly\n     * @member #params\n     */\n    this.set(\"params\", {});\n\n    this.on(\"change:value\", (evt, name, value) => {\n      this.type = \"url\";\n      this.params = {};\n\n      if (value) {\n        const { getLinkActions } = useModule(\"app_components\");\n        const actions = getLinkActions(value);\n\n        if (actions && actions.length > 0) {\n          const action = actions[0];\n\n          this.params = omit(action, [\"type\"]);\n\n          switch (action.type) {\n            case \"page\":\n              this.type = action.type;\n              this.params.index++;\n              break;\n\n            case \"showBlock\":\n              this.type = \"toggle\";\n              this.params.action = \"show\";\n              break;\n            case \"hideBlock\":\n              this.type = \"toggle\";\n              this.params.action = \"hide\";\n              break;\n            case \"toggleBlock\":\n              this.type = \"toggle\";\n              this.params.action = \"toggle\";\n              break;\n\n            case \"enterFullscreen\":\n              this.type = \"fullscreen\";\n              this.params.action = \"enter\";\n              break;\n            case \"exitFullscreen\":\n              this.type = \"fullscreen\";\n              this.params.action = \"exit\";\n              break;\n            case \"toggleFullscreen\":\n              this.type = \"fullscreen\";\n              this.params.action = \"toggle\";\n              break;\n\n            default:\n              this.type = action.type;\n          }\n        }\n      }\n    });\n  }\n}\n","import { LinkEditing } from \"@ckeditor/ckeditor5-link\";\n\nimport CustomLinkCommand from \"./linkcommand\";\n\nexport default class CustomLinkEditing extends LinkEditing {\n  static get pluginName() {\n    return \"CustomLinkEditing\";\n  }\n\n  /**\n   * @inheritDoc\n   */\n  init() {\n    super.init();\n\n    const editor = this.editor;\n    editor.commands.add(\"link\", new CustomLinkCommand(editor));\n  }\n}\n","import { AutoLink } from \"@ckeditor/ckeditor5-link\";\n\nimport CustomLinkEditing from \"./linkediting\";\n\nexport default class CustomAutoLink extends AutoLink {\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [\"Delete\", CustomLinkEditing];\n  }\n\n  static get pluginName() {\n    return \"CustomAutoLink\";\n  }\n}\n","import { InputView } from \"@ckeditor/ckeditor5-ui\";\nimport \"timecode-input\";\n\nimport \"../../theme/inputtimecodeview.scss\";\n\n/**\n * The timecode input view class.\n */\nexport default class InputTimecodeView extends InputView {\n  /**\n   * Creates an instance of the input view.\n   *\n   * @param {module:utils/locale~Locale} locale The {@link module:core/editor/editor~Editor#locale} instance.\n   * @param {Object} [options] The options of the input.\n   * @param {Number} [options.min] The value of the `min` DOM attribute (the lowest accepted value).\n   * @param {Number} [options.max] The value of the `max` DOM attribute (the highest accepted value).\n   */\n  constructor(locale, { min, max } = {}) {\n    super(locale);\n\n    const bind = this.bindTemplate;\n\n    /**\n     * The value of the `min` DOM attribute (the lowest accepted value) set on the {@link #element}.\n     *\n     * @observable\n     * @default undefined\n     * @member {Number} #min\n     */\n    this.set(\"min\", min);\n\n    /**\n     * The value of the `max` DOM attribute (the highest accepted value) set on the {@link #element}.\n     *\n     * @observable\n     * @default undefined\n     * @member {Number} #max\n     */\n    this.set(\"max\", max);\n\n    this.inputMode = null;\n\n    // extendTemplate doesn't allow changing the tag.\n    this.template.tag = \"timecode-input\";\n\n    this.extendTemplate({\n      attributes: {\n        class: [\"ck-input-timecode\"],\n        min: bind.to(\"min\"),\n        max: bind.to(\"max\"),\n      },\n    });\n  }\n\n  /**\n   * @inheritdoc\n   */\n  _updateIsEmpty() {\n    this.isEmpty = this.element.value === null;\n  }\n}\n","import { Collection } from \"@ckeditor/ckeditor5-utils\";\nimport { ViewModel } from \"@ckeditor/ckeditor5-ui\";\nimport { useModule } from \"@metascore-library/core/services/module-manager\";\nimport InputTimecodeView from \"./inputtimecodeview\";\n\nexport function createLabeledInputTimecode(\n  labeledFieldView,\n  viewUid,\n  statusUid\n) {\n  const inputView = new InputTimecodeView(labeledFieldView.locale);\n\n  inputView.set({\n    id: viewUid,\n    ariaDescribedById: statusUid,\n  });\n\n  inputView\n    .bind(\"isReadOnly\")\n    .to(labeledFieldView, \"isEnabled\", (value) => !value);\n  inputView\n    .bind(\"hasError\")\n    .to(labeledFieldView, \"errorText\", (value) => !!value);\n\n  inputView.on(\"input\", () => {\n    // UX: Make the error text disappear and disable the error indicator as the user\n    // starts fixing the errors.\n    labeledFieldView.errorText = null;\n  });\n\n  labeledFieldView.bind(\"isEmpty\", \"isFocused\", \"placeholder\").to(inputView);\n\n  return inputView;\n}\n\nexport function getTypeLabels(t) {\n  return {\n    play: t(\"Play\"),\n    pause: t(\"Pause\"),\n    stop: t(\"Stop\"),\n    seek: t(\"Seek\"),\n    page: t(\"Page\"),\n    toggle: t(\"Show/hide a block\"),\n    scenario: t(\"Scenario\"),\n    fullscreen: t(\"Fullscreen\"),\n    url: t(\"URL\"),\n  };\n}\n\nexport function getComponentLabels(type) {\n  const { getComponentsByType } = useModule(\"app_components\");\n\n  const labels = {};\n  getComponentsByType(type).forEach((c) => {\n    labels[c.id] = c.name;\n  });\n  return labels;\n}\n\nexport function getToggleActionLabels(t) {\n  return {\n    show: t(\"Show\"),\n    hide: t(\"Hide\"),\n    toggle: t(\"Toggle\"),\n  };\n}\n\nexport function getFullscreenActionLabels(t) {\n  return {\n    enter: t(\"Enter\"),\n    exit: t(\"Exit\"),\n    toggle: t(\"Toggle\"),\n  };\n}\n\nexport function getDropdownDefinitions(labels) {\n  const itemDefinitions = new Collection();\n\n  Object.entries(labels).forEach(([key, label]) => {\n    const definition = {\n      type: \"button\",\n      model: new ViewModel({\n        _value: key,\n        label: label,\n        withText: true,\n      }),\n    };\n\n    itemDefinitions.add(definition);\n  });\n\n  return itemDefinitions;\n}\n","import { View } from \"@ckeditor/ckeditor5-ui\";\n\nimport \"../../theme/formgroup.scss\";\n\nexport default class FormGroupView extends View {\n  /**\n   * Creates an instance of the form group class.\n   *\n   * @param {module:utils/locale~Locale} locale The locale instance.\n   * @param {Object} options\n   * @param {Array.<module:ui/view~View>} options.children\n   * @param {String} [options.class]\n   * DOM attributes and gets described by the label.\n   */\n  constructor(locale, options = {}) {\n    super(locale);\n\n    const bind = this.bindTemplate;\n\n    /**\n     * Controls whether the groupis visible. Visible by default, groups are hidden\n     * using a CSS class.\n     *\n     * @observable\n     * @default true\n     * @member {Boolean} #isVisible\n     */\n    this.set(\"isVisible\", true);\n\n    /**\n     * An additional CSS class added to the {@link #element}.\n     *\n     * @observable\n     * @member {String} #class\n     */\n    this.set(\"class\", options.class || null);\n\n    /**\n     * A collection of row items (buttons, dropdowns, etc.).\n     *\n     * @readonly\n     * @member {module:ui/viewcollection~ViewCollection}\n     */\n    this.children = this.createCollection();\n\n    if (options.children) {\n      options.children.forEach((child) => this.children.add(child));\n    }\n\n    /**\n     * The role property reflected by the `role` DOM attribute of the {@link #element}.\n     *\n     * **Note**: Used only when a `labelView` is passed to constructor `options`.\n     *\n     * @private\n     * @observable\n     * @member {String} #role\n     */\n    this.set(\"_role\", null);\n\n    this.setTemplate({\n      tag: \"div\",\n      attributes: {\n        class: [\n          \"ck\",\n          \"ck-form__group\",\n          bind.to(\"class\"),\n          bind.if(\"isVisible\", \"ck-hidden\", (value) => !value),\n        ],\n        role: bind.to(\"_role\"),\n        \"z-index\": \"-1\",\n      },\n      children: this.children,\n    });\n  }\n}\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\">\\n  <path fill=\\\"currentColor\\\" d=\\\"M11.414 10l4.293-4.293a.999.999 0 1 0-1.414-1.414L10 8.586 5.707 4.293a.999.999 0 1 0-1.414 1.414L8.586 10l-4.293 4.293a.999.999 0 1 0 1.414 1.414L10 11.414l4.293 4.293a.997.997 0 0 0 1.414 0 .999.999 0 0 0 0-1.414L11.414 10z\\\"/>\\n</svg>\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\">\\n  <path fill=\\\"currentColor\\\" d=\\\"M9.293 13.707l-3-3a.999.999 0 1 1 1.414-1.414L9 10.586V3a1 1 0 1 1 2 0v7.586l1.293-1.293a.999.999 0 1 1 1.414 1.414l-3 3a.999.999 0 0 1-1.414 0zM17 16a1 1 0 1 1 0 2H3a1 1 0 1 1 0-2h14z\\\"/>\\n</svg>\\n\";","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\">\\n  <path fill=\\\"currentColor\\\" d=\\\"M13.707 6.707a.997.997 0 0 1-1.414 0L11 5.414V13a1 1 0 1 1-2 0V5.414L7.707 6.707a.999.999 0 1 1-1.414-1.414l3-3a.999.999 0 0 1 1.414 0l3 3a.999.999 0 0 1 0 1.414zM17 18H3a1 1 0 1 1 0-2h14a1 1 0 1 1 0 2z\\\"/>\\n</svg>\\n\";","import {\n  LabeledFieldView,\n  ButtonView,\n  ToolbarView,\n} from \"@ckeditor/ckeditor5-ui\";\nimport { useModule } from \"@metascore-library/core/services/module-manager\";\nimport { unref } from \"vue\";\nimport { createLabeledInputTimecode } from \"./utils\";\n\nimport clearIcon from \"../../theme/icons/clear.svg\";\nimport inIcon from \"../../theme/icons/in.svg\";\nimport outIcon from \"../../theme/icons/out.svg\";\n\nimport \"../../theme/labeledtimecodefield.scss\";\n\n/**\n * The labeled timecode field view class.\n */\nexport default class LabeledTimecodeFieldView extends LabeledFieldView {\n  /**\n   * Creates an instance of the labeled field view.\n   *\n   * @param {module:utils/locale~Locale} locale The {@link module:core/editor/editor~Editor#locale} instance.\n   * @param {Object} [options] The options of the input.\n   * @param {Boolean} [options.in_button=true] Whether to add the 'in' button.\n   * @param {Boolean} [options.out_button=true] Whether to add the 'out' button.\n   * @param {Boolean} [options.clear_button=true] Whether to add the 'clear' button.\n   */\n  constructor(\n    locale,\n    { in_button = true, out_button = true, clear_button = true } = {}\n  ) {\n    super(locale, createLabeledInputTimecode);\n\n    const t = locale.t;\n    const { time: mediaTime, seekTo: seekMediaTo } = useModule(\"media_player\");\n\n    this.toolbarView = null;\n\n    const buttons = [];\n\n    if (in_button) {\n      this.inButton = new ButtonView(locale);\n      this.inButton.set({\n        icon: inIcon,\n        tooltip: t(\"Set value to current media time\"),\n      });\n      this.inButton.on(\"execute\", () => {\n        this.fieldView.value = unref(mediaTime);\n        this.fieldView.fire(\"input\");\n      });\n      buttons.push(this.inButton);\n    }\n\n    if (out_button) {\n      this.outButton = new ButtonView(locale);\n      this.outButton.set({\n        icon: outIcon,\n        tooltip: t(\"Set current media time to this value\"),\n      });\n      this.outButton.on(\"execute\", () => {\n        seekMediaTo(this.fieldView.value);\n      });\n      buttons.push(this.outButton);\n    }\n\n    if (clear_button) {\n      this.clearButton = new ButtonView(locale);\n      this.clearButton.set({\n        icon: clearIcon,\n        tooltip: t(\"Clear value\"),\n      });\n      this.clearButton.on(\"execute\", () => {\n        this.fieldView.value = null;\n        this.fieldView.fire(\"input\");\n      });\n      buttons.push(this.clearButton);\n    }\n\n    if (buttons.length > 0) {\n      this.toolbarView = new ToolbarView(locale);\n      this.toolbarView.items.addMany(buttons);\n      this.fieldWrapperChildren.add(this.toolbarView);\n    }\n\n    this.extendTemplate({\n      attributes: {\n        class: [\"ck-labeled-field-view_timecode\"],\n      },\n    });\n  }\n\n  /**\n   * @inheritdoc\n   */\n  render() {\n    super.render();\n\n    if (this.toolbarView) {\n      this.fieldView.focusTracker.add(this.toolbarView.element);\n    }\n  }\n}\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\" xml:space=\\\"preserve\\\">\\n  <path fill=\\\"currentColor\\\" d=\\\"M10 .4C4.697.4.399 4.698.399 10A9.6 9.6 0 0 0 10 19.601c5.301 0 9.6-4.298 9.6-9.601 0-5.302-4.299-9.6-9.6-9.6zm.896 3.466c.936 0 1.211.543 1.211 1.164 0 .775-.62 1.492-1.679 1.492-.886 0-1.308-.445-1.282-1.182 0-.621.519-1.474 1.75-1.474zM8.498 15.75c-.64 0-1.107-.389-.66-2.094l.733-3.025c.127-.484.148-.678 0-.678-.191 0-1.022.334-1.512.664l-.319-.523c1.555-1.299 3.343-2.061 4.108-2.061.64 0 .746.756.427 1.92l-.84 3.18c-.149.562-.085.756.064.756.192 0 .82-.232 1.438-.719l.362.486c-1.513 1.512-3.162 2.094-3.801 2.094z\\\"/>\\n</svg>\";","import LinkFormView from \"@ckeditor/ckeditor5-link/src/ui/linkformview\";\nimport {\n  LabeledFieldView,\n  createLabeledDropdown,\n  createLabeledInputNumber,\n  addListToDropdown,\n  SwitchButtonView,\n  ButtonView,\n} from \"@ckeditor/ckeditor5-ui\";\nimport {\n  getTypeLabels,\n  getComponentLabels,\n  getToggleActionLabels,\n  getFullscreenActionLabels,\n  getDropdownDefinitions,\n} from \"./utils\";\nimport FormGroupView from \"./formgroupview\";\nimport LabeledTimecodeFieldView from \"./labeledtimecodefieldview\";\n\nimport tipIcon from \"../../theme/icons/tip.svg\";\n\nimport \"../../theme/linkform.scss\";\n\nexport default class CustomLinkFormView extends LinkFormView {\n  /**\n   * @inheritDoc\n   */\n  constructor(locale, linkCommand) {\n    super(locale, linkCommand);\n\n    const t = this.locale.t;\n\n    /**\n     * The link type\n     *\n     * @observable\n     * @member {String} #type\n     */\n    this.set(\"type\", null);\n\n    /**\n     * A collection of link parameters.\n     *\n     * @protected\n     * @observable\n     * @member {Object} #params\n     */\n    this.set(\"params\", {});\n\n    this.on(\"change:type\", (evt, name, value) => {\n      this.urlInputView.fieldView.value = \"\";\n\n      // Set action defaults.\n      switch (value) {\n        case \"seek\":\n          this.params = {\n            time: 0,\n          };\n          break;\n\n        case \"toggle\":\n          this.params = {\n            action: \"show\",\n          };\n          break;\n\n        case \"fullscreen\":\n          this.params = {\n            action: \"enter\",\n          };\n          break;\n\n        default:\n          this.params = {};\n      }\n    });\n\n    this.on(\"change:params\", () => {\n      this.updateValue();\n    });\n\n    // Add a placeholder to the URL field\n    this.urlInputView.fieldView.placeholder = t(\"https://example.com\");\n  }\n\n  /**\n   * @inheritDoc\n   */\n  render() {\n    super.render();\n\n    const extraChildViews = [\n      this.typeInputView,\n      this._playInputsGroup,\n      this._seekInputsGroup,\n      this._pageInputsGroup,\n      this._blockToggleInputsGroup,\n      this._scenarioInputsGroup,\n      this._fullscreenInputsGroup,\n    ];\n\n    this._focusables.addMany(extraChildViews, 0);\n\n    extraChildViews.forEach((v) => {\n      // Register the view in the focus tracker.\n      this.focusTracker.add(v.element);\n    });\n  }\n\n  /**\n   * Creates a labeled \"type\" input.\n   *\n   * @private\n   * @returns {LabeledFieldView} Labeled field view instance.\n   */\n  _createTypeInput() {\n    const t = this.locale.t;\n\n    const typeLabels = getTypeLabels(this.t);\n    const dropdown = new LabeledFieldView(this.locale, createLabeledDropdown);\n    dropdown.set({\n      label: t(\"Type\"),\n    });\n    dropdown.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    dropdown.fieldView.buttonView.bind(\"label\").to(this, \"type\", (value) => {\n      return typeLabels[value];\n    });\n    dropdown.fieldView.on(\"execute\", (evt) => {\n      this.type = evt.source._value;\n    });\n    dropdown.bind(\"isEmpty\").to(this, \"type\", (value) => !value);\n\n    const dropdownDefinitions = getDropdownDefinitions(typeLabels);\n    dropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"type\", (value) => {\n        return value === definition.model._value;\n      });\n    });\n    addListToDropdown(dropdown.fieldView, dropdownDefinitions);\n\n    return dropdown;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  _createUrlInput() {\n    const labeledInput = super._createUrlInput();\n\n    // Hide the input when the type is not \"url\".\n    const bind = this.bindTemplate;\n    labeledInput.extendTemplate({\n      attributes: {\n        // ck-hidden seems to cause focus/selection issues.\n        // see https://github.com/philharmoniedeparis/metascore-library/issues/704\n        class: bind.if(\"type\", \"ck-fake-hidden\", (value) => value !== \"url\"),\n      },\n    });\n\n    return labeledInput;\n  }\n\n  /**\n   * Creates a group of inputs for \"play\" links.\n   *\n   * @private\n   * @returns {FormGroupView} Form group view instance.\n   */\n  _createPlayInputs() {\n    const locale = this.locale;\n    const t = locale.t;\n    const bind = this.bindTemplate;\n\n    // Excerpt.\n    this.playExcerptInputView = new SwitchButtonView(locale);\n    this.playExcerptInputView.set({\n      label: t(\"Excerpt\"),\n      withText: true,\n    });\n    this.playExcerptInputView\n      .bind(\"isOn\")\n      .to(this, \"params\", (params) => !!params?.excerpt);\n    this.playExcerptInputView.on(\"execute\", () => {\n      this.params = {\n        ...this.params,\n        excerpt: !this.params?.excerpt,\n      };\n    });\n\n    // Start time.\n    this.playStartInputView = new LabeledTimecodeFieldView(locale);\n    this.playStartInputView.set({\n      label: t(\"Start time\"),\n    });\n    this.playStartInputView.fieldView\n      .bind(\"value\")\n      .to(this, \"params\", (params) => params?.start);\n    this.playStartInputView.fieldView.on(\"input\", () => {\n      this.params = {\n        ...this.params,\n        start: this.playStartInputView.fieldView.element.value,\n      };\n    });\n    this.playStartInputView.extendTemplate({\n      attributes: {\n        class: bind.if(\"params\", \"ck-hidden\", (value) => !value?.excerpt),\n      },\n    });\n\n    // End time.\n    this.playEndInputView = new LabeledTimecodeFieldView(locale);\n    this.playEndInputView.set({\n      label: t(\"End time\"),\n    });\n    this.playEndInputView.fieldView\n      .bind(\"value\")\n      .to(this, \"params\", (params) => params?.end);\n    this.playEndInputView.fieldView.on(\"input\", () => {\n      this.params = {\n        ...this.params,\n        end: this.playEndInputView.fieldView.element.value,\n      };\n    });\n    this.playEndInputView.extendTemplate({\n      attributes: {\n        class: bind.if(\"params\", \"ck-hidden\", (value) => !value?.excerpt),\n      },\n    });\n\n    // Scenario.\n    const scenarioLabels = getComponentLabels(\"Scenario\");\n    this.playScenarioInputView = new LabeledFieldView(\n      locale,\n      createLabeledDropdown\n    );\n    this.playScenarioInputView.set({\n      label: t(\"Scenario\"),\n    });\n    this.playScenarioInputView.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    this.playScenarioInputView.fieldView.buttonView\n      .bind(\"label\")\n      .to(this, \"params\", (params) => scenarioLabels[params?.scenario]);\n    this.playScenarioInputView.fieldView.on(\"execute\", (evt) => {\n      this.params = {\n        ...this.params,\n        scenario: evt.source._value,\n      };\n    });\n    this.playScenarioInputView\n      .bind(\"isEmpty\")\n      .to(this, \"params\", (params) => !params?.scenario);\n    this.playScenarioInputView.extendTemplate({\n      attributes: {\n        class: bind.if(\"params\", \"ck-hidden\", (value) => !value?.excerpt),\n      },\n    });\n\n    const dropdownDefinitions = getDropdownDefinitions(scenarioLabels);\n    dropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"params\", (value) => {\n        return value?.scenario === definition.model._value;\n      });\n    });\n    addListToDropdown(\n      this.playScenarioInputView.fieldView,\n      dropdownDefinitions\n    );\n\n    // Auto-highlight.\n    this.playHighlightInputView = new SwitchButtonView(locale);\n    this.playHighlightInputView.set({\n      label: t(\"Auto-highlight\"),\n      withText: true,\n      tooltip: t(\n        \"Highlight the link when the current media time is between its time limits\"\n      ),\n    });\n    this.playHighlightInputView\n      .bind(\"isOn\")\n      .to(this, \"params\", (params) => !!params?.highlight);\n    this.playHighlightInputView.on(\"execute\", () => {\n      this.params = {\n        ...this.params,\n        highlight: !this.params?.highlight,\n      };\n    });\n    this.playHighlightInputView.extendTemplate({\n      attributes: {\n        class: bind.if(\"params\", \"ck-hidden\", (value) => !value?.excerpt),\n      },\n    });\n\n    const inputs = new FormGroupView(locale, {\n      children: [\n        this.playExcerptInputView,\n        this.playStartInputView,\n        this.playEndInputView,\n        this.playScenarioInputView,\n        this.playHighlightInputView,\n      ],\n    });\n    inputs.bind(\"isVisible\").to(this, \"type\", (value) => value === \"play\");\n\n    return inputs;\n  }\n\n  /**\n   * Creates a group of inputs for \"seek\" links.\n   *\n   * @private\n   * @returns {FormGroupView} Form group view instance.\n   */\n  _createSeekInputs() {\n    const locale = this.locale;\n    const t = locale.t;\n\n    // Time.\n    this.seekTimeInputView = new LabeledTimecodeFieldView(locale, {\n      clear_button: false,\n    });\n    this.seekTimeInputView.set({\n      label: t(\"Time\"),\n    });\n    this.seekTimeInputView.fieldView\n      .bind(\"value\")\n      .to(this, \"params\", (params) => params?.time);\n    this.seekTimeInputView.fieldView.on(\"input\", () => {\n      this.params = {\n        ...this.params,\n        time: this.seekTimeInputView.fieldView.element.value,\n      };\n    });\n\n    const inputs = new FormGroupView(locale, {\n      children: [this.seekTimeInputView],\n    });\n    inputs.bind(\"isVisible\").to(this, \"type\", (value) => value === \"seek\");\n\n    return inputs;\n  }\n\n  /**\n   * Creates a group of inputs for \"page\" links.\n   *\n   * @private\n   * @returns {FormGroupView} Form group view instance.\n   */\n  _createPageInputs() {\n    const locale = this.locale;\n    const t = locale.t;\n\n    // Block.\n    const blockLabels = Object.fromEntries(\n      Object.values(getComponentLabels(\"Block\")).map((val) => [val, val])\n    );\n    this.pageBlockInputView = new LabeledFieldView(\n      locale,\n      createLabeledDropdown\n    );\n    this.pageBlockInputView.set({\n      label: t(\"Block\"),\n    });\n    this.pageBlockInputView.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    this.pageBlockInputView.fieldView.buttonView\n      .bind(\"label\")\n      .to(this, \"params\", (params) => params?.block);\n    this.pageBlockInputView.fieldView.on(\"execute\", (evt) => {\n      this.params = {\n        ...this.params,\n        block: evt.source._value,\n      };\n    });\n    this.pageBlockInputView\n      .bind(\"isEmpty\")\n      .to(this, \"params\", (params) => !params?.block);\n\n    const dropdownDefinitions = getDropdownDefinitions(blockLabels);\n    dropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"params\", (value) => {\n        return value?.block === definition.model._value;\n      });\n    });\n    addListToDropdown(this.pageBlockInputView.fieldView, dropdownDefinitions);\n\n    // Index.\n    this.pageIndexInputView = new LabeledFieldView(\n      locale,\n      createLabeledInputNumber\n    );\n    this.pageIndexInputView.set({\n      label: t(\"Page\"),\n    });\n    this.pageIndexInputView.fieldView.set({\n      min: 1,\n      step: 1,\n    });\n    this.pageIndexInputView.fieldView\n      .bind(\"value\")\n      .to(this, \"params\", (params) => params?.index);\n    this.pageIndexInputView.fieldView.on(\"input\", () => {\n      this.params = {\n        ...this.params,\n        index: parseInt(this.pageIndexInputView.fieldView.element.value),\n      };\n    });\n\n    const inputs = new FormGroupView(locale, {\n      children: [this.pageBlockInputView, this.pageIndexInputView],\n    });\n    inputs.bind(\"isVisible\").to(this, \"type\", (value) => value === \"page\");\n\n    return inputs;\n  }\n\n  /**\n   * Creates a group of inputs for \"(show|hide|toggle)Block\" links.\n   *\n   * @private\n   * @returns {FormGroupView} Form group view instance.\n   */\n  _createBlockToggleInputs() {\n    const locale = this.locale;\n    const t = locale.t;\n\n    // Block.\n    const blockLabels = Object.fromEntries(\n      Object.values(getComponentLabels(\"Block\")).map((val) => [val, val])\n    );\n    this.toggleBlockInputView = new LabeledFieldView(\n      locale,\n      createLabeledDropdown\n    );\n    this.toggleBlockInputView.set({\n      label: t(\"Block\"),\n    });\n    this.toggleBlockInputView.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    this.toggleBlockInputView.fieldView.buttonView\n      .bind(\"label\")\n      .to(this, \"params\", (params) => params?.name);\n    this.toggleBlockInputView.fieldView.on(\"execute\", (evt) => {\n      this.params = {\n        ...this.params,\n        name: evt.source._value,\n      };\n    });\n    this.toggleBlockInputView\n      .bind(\"isEmpty\")\n      .to(this, \"params\", (params) => !params?.name);\n    const nameDropdownDefinitions = getDropdownDefinitions(blockLabels);\n    nameDropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"params\", (value) => {\n        return value?.name === definition.model._value;\n      });\n    });\n    addListToDropdown(\n      this.toggleBlockInputView.fieldView,\n      nameDropdownDefinitions\n    );\n\n    // Action.\n    const actionLabels = getToggleActionLabels(t);\n    this.toggleActionInputView = new LabeledFieldView(\n      locale,\n      createLabeledDropdown\n    );\n    this.toggleActionInputView.set({\n      label: t(\"Action\"),\n    });\n    this.toggleActionInputView.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    this.toggleActionInputView.fieldView.buttonView\n      .bind(\"label\")\n      .to(this, \"params\", (params) => actionLabels[params?.action]);\n    this.toggleActionInputView.fieldView.on(\"execute\", (evt) => {\n      this.params = {\n        ...this.params,\n        action: evt.source._value,\n      };\n    });\n    this.toggleActionInputView\n      .bind(\"isEmpty\")\n      .to(this, \"params\", (params) => !params?.action);\n    const actionDropdownDefinitions = getDropdownDefinitions(actionLabels);\n    actionDropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"params\", (value) => {\n        return value?.action === definition.model._value;\n      });\n    });\n    addListToDropdown(\n      this.toggleActionInputView.fieldView,\n      actionDropdownDefinitions\n    );\n\n    const inputs = new FormGroupView(locale, {\n      children: [this.toggleBlockInputView, this.toggleActionInputView],\n    });\n    inputs.bind(\"isVisible\").to(this, \"type\", (value) => value === \"toggle\");\n\n    return inputs;\n  }\n\n  /**\n   * Creates a group of inputs for \"scenario\" links.\n   *\n   * @private\n   * @returns {FormGroupView} Form group view instance.\n   */\n  _createScenarioInputs() {\n    const locale = this.locale;\n    const t = locale.t;\n\n    // Scenario.\n    const scenarioLabels = getComponentLabels(\"Scenario\");\n    this.scenarioScenarioInputView = new LabeledFieldView(\n      locale,\n      createLabeledDropdown\n    );\n    this.scenarioScenarioInputView.set({\n      label: t(\"Scenario\"),\n    });\n    this.scenarioScenarioInputView.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    this.scenarioScenarioInputView.fieldView.buttonView\n      .bind(\"label\")\n      .to(this, \"params\", (params) => {\n        return scenarioLabels[params?.id];\n      });\n    this.scenarioScenarioInputView.fieldView.on(\"execute\", (evt) => {\n      this.params = {\n        ...this.params,\n        id: evt.source._value,\n      };\n    });\n    this.scenarioScenarioInputView\n      .bind(\"isEmpty\")\n      .to(this, \"params\", (params) => !params?.id);\n    const idDropdownDefinitions = getDropdownDefinitions(scenarioLabels);\n    idDropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"params\", (value) => {\n        return value?.id === definition.model._value;\n      });\n    });\n    addListToDropdown(\n      this.scenarioScenarioInputView.fieldView,\n      idDropdownDefinitions\n    );\n\n    const inputs = new FormGroupView(locale, {\n      children: [this.scenarioScenarioInputView],\n    });\n    inputs.bind(\"isVisible\").to(this, \"type\", (value) => value === \"scenario\");\n\n    return inputs;\n  }\n\n  /**\n   * Creates a group of inputs for \"(enter|exit|toggle)Fullscreen\" links.\n   *\n   * @private\n   * @returns {FormGroupView} Form group view instance.\n   */\n  _createFullscreenInputs() {\n    const locale = this.locale;\n    const t = locale.t;\n\n    // Action.\n    const actionLabels = getFullscreenActionLabels(t);\n    this.fullscreenActionInputView = new LabeledFieldView(\n      locale,\n      createLabeledDropdown\n    );\n    this.fullscreenActionInputView.set({\n      label: t(\"Action\"),\n    });\n    this.fullscreenActionInputView.fieldView.buttonView.set({\n      isOn: false,\n      withText: true,\n    });\n    this.fullscreenActionInputView.fieldView.buttonView\n      .bind(\"label\")\n      .to(this, \"params\", (params) => actionLabels[params?.action]);\n    this.fullscreenActionInputView.fieldView.on(\"execute\", (evt) => {\n      this.params = {\n        ...this.params,\n        action: evt.source._value,\n      };\n    });\n    this.fullscreenActionInputView\n      .bind(\"isEmpty\")\n      .to(this, \"params\", (params) => !params?.action);\n    const actionDropdownDefinitions = getDropdownDefinitions(actionLabels);\n    actionDropdownDefinitions.map((definition) => {\n      definition.model.bind(\"isOn\").to(this, \"params\", (value) => {\n        return value?.action === definition.model._value;\n      });\n    });\n    addListToDropdown(\n      this.fullscreenActionInputView.fieldView,\n      actionDropdownDefinitions\n    );\n\n    const inputs = new FormGroupView(locale, {\n      children: [this.fullscreenActionInputView],\n    });\n    inputs\n      .bind(\"isVisible\")\n      .to(this, \"type\", (value) => value === \"fullscreen\");\n\n    return inputs;\n  }\n\n  /**\n   * Creates the tip icon view.\n   *\n   * @private\n   * @returns {IconView}\n   */\n  _createTipView() {\n    const locale = this.locale;\n    const t = locale.t;\n    const view = new ButtonView(locale);\n\n    view.set({\n      icon: tipIcon,\n      withText: false,\n      tooltip: t(\n        'TIP: Use the \"behaviors\" to program all the actions\\nyou want when clicking on a text or an image!'\n      ),\n    });\n\n    view.extendTemplate({\n      attributes: {\n        class: \"ck-link__tip\",\n      },\n    });\n\n    return view;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  _createFormChildren(manualDecorators) {\n    const children = super._createFormChildren(manualDecorators);\n\n    this.typeInputView = this._createTypeInput();\n    this._playInputsGroup = this._createPlayInputs();\n    this._seekInputsGroup = this._createSeekInputs();\n    this._pageInputsGroup = this._createPageInputs();\n    this._blockToggleInputsGroup = this._createBlockToggleInputs();\n    this._scenarioInputsGroup = this._createScenarioInputs();\n    this._fullscreenInputsGroup = this._createFullscreenInputs();\n    this._tipView = this._createTipView();\n\n    children.addMany(\n      [\n        this.typeInputView,\n        this._playInputsGroup,\n        this._seekInputsGroup,\n        this._pageInputsGroup,\n        this._blockToggleInputsGroup,\n        this._scenarioInputsGroup,\n        this._fullscreenInputsGroup,\n      ],\n      0\n    );\n\n    children.add(this._tipView);\n\n    return children;\n  }\n\n  /**\n   * Update the URL input value.\n   */\n  updateValue() {\n    if (this.type === \"url\") return;\n\n    const type = this.type;\n    const params = this.params;\n\n    let value = \"\";\n\n    switch (type) {\n      case \"play\":\n        value = `#${type}`;\n        if (params?.excerpt) {\n          value += `=${params.start ?? \"\"}`;\n          value += `,${params.end ?? \"\"}`;\n          value += `,${params.scenario ?? \"\"}`;\n\n          if (params?.highlight) {\n            value += \",1\";\n          }\n        }\n        break;\n\n      case \"seek\":\n        value = `#${type}=${params.time}`;\n        break;\n\n      case \"page\":\n        value = `#${type}=${params.block},${params.index}`;\n        break;\n\n      case \"toggle\":\n        value = `#${params.action}Block=${params.name}`;\n        break;\n\n      case \"scenario\":\n        value = `#scenario=${params.id}`;\n        break;\n\n      case \"fullscreen\":\n        value = `#${params.action}Fullscreen`;\n        break;\n\n      default:\n        value = type ? `#${type}` : \"\";\n    }\n\n    this.urlInputView.fieldView.value = value;\n\n    this.fire(\"update\");\n  }\n}\n\n/**\n * Fired when the form view's value is updated.\n *\n * @event update\n */\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xml:space=\\\"preserve\\\" viewBox=\\\"0 0 22 22\\\">\\n  <path d=\\\"M12.069 13.455c.308.307.338.781.063 1.055l-4.555 4.553c-.271.271-.747.244-1.053-.064l-3.526-3.523c-.306-.309-.334-.781-.063-1.055L7.49 9.867c.272-.272.747-.243 1.053.063.307.306.337.781.064 1.053l-3.564 3.565c-.272.271-.245.746.063 1.053l1.29 1.291c.308.307.782.334 1.055.064l3.563-3.564c.274-.273.748-.246 1.055.063M19 6.526c.307.306.336.78.063 1.053l-4.554 4.554c-.27.271-.747.244-1.054-.063-.307-.308-.336-.782-.065-1.055l3.565-3.563c.273-.272.243-.747-.063-1.053l-1.29-1.291c-.307-.308-.78-.337-1.053-.064l-3.566 3.563c-.271.273-.746.244-1.053-.063-.307-.306-.335-.781-.064-1.052l4.555-4.555c.271-.272.747-.243 1.053.063L19 6.526z\\\"/>\\n  <path d=\\\"M14.217 7.783c.31.308.338.78.063 1.053l-5.446 5.445c-.27.271-.745.242-1.053-.064-.306-.305-.335-.781-.063-1.053l5.446-5.444c.272-.274.747-.245 1.053.063\\\"/>\\n</svg>\\n\";","import { LinkUI } from \"@ckeditor/ckeditor5-link\";\nimport { ButtonView } from \"@ckeditor/ckeditor5-ui\";\nimport {\n  addLinkProtocolIfApplicable,\n  LINK_KEYSTROKE,\n} from \"@ckeditor/ckeditor5-link/src/utils\";\nimport { CssTransitionDisablerMixin } from \"@ckeditor/ckeditor5-ui\";\nimport CustomLinkFormView from \"./ui/linkformview\";\n\nimport linkIcon from \"../theme/icons/link.svg\";\n\nexport default class CustomLinkUI extends LinkUI {\n  static get pluginName() {\n    return \"CustomLinkUI\";\n  }\n\n  /**\n   * @inheritDoc\n   */\n  _createFormView() {\n    const editor = this.editor;\n    const linkCommand = editor.commands.get(\"link\");\n    const defaultProtocol = editor.config.get(\"link.defaultProtocol\");\n    const allowCreatingEmptyLinks = editor.config.get(\n      \"link.allowCreatingEmptyLinks\"\n    );\n\n    const formView = new (CssTransitionDisablerMixin(CustomLinkFormView))(\n      editor.locale,\n      linkCommand\n    );\n\n    formView.urlInputView.fieldView.bind(\"value\").to(linkCommand, \"value\");\n\n    // Form elements should be read-only when corresponding commands are disabled.\n    formView.typeInputView.bind(\"isEnabled\").to(linkCommand, \"isEnabled\");\n    formView.urlInputView.bind(\"isEnabled\").to(linkCommand, \"isEnabled\");\n\n    // Disable the \"save\" button if the command is disabled or the input is empty despite being required.\n    formView.saveButtonView\n      .bind(\"isEnabled\")\n      .to(\n        linkCommand,\n        \"isEnabled\",\n        formView.urlInputView,\n        \"isEmpty\",\n        (isCommandEnabled, isInputEmpty) =>\n          isCommandEnabled && (allowCreatingEmptyLinks || !isInputEmpty)\n      );\n\n    // Execute link command after clicking the \"Save\" button.\n    this.listenTo(formView, \"submit\", () => {\n      const { value } = formView.urlInputView.fieldView.element;\n      const parsedUrl = addLinkProtocolIfApplicable(value, defaultProtocol);\n      editor.execute(\"link\", parsedUrl, formView.getDecoratorSwitchesState());\n      this._closeFormView();\n    });\n\n    // Hide the panel after clicking the \"Cancel\" button.\n    this.listenTo(formView, \"cancel\", () => {\n      this._closeFormView();\n    });\n\n    // Close the panel on esc key press when the **form has focus**.\n    formView.keystrokes.set(\"Esc\", (data, cancel) => {\n      this._closeFormView();\n      cancel();\n    });\n\n    // Update the balloon's position when the form updates.\n    formView.on(\"update\", () => {\n      if (this._isUIVisible) {\n        this._balloon.updatePosition();\n      }\n    });\n\n    return formView;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  _createToolbarLinkButton() {\n    const editor = this.editor;\n    const linkCommand = editor.commands.get(\"link\");\n    const t = editor.t;\n\n    editor.ui.componentFactory.add(\"link\", (locale) => {\n      const button = new ButtonView(locale);\n\n      button.isEnabled = true;\n      button.label = t(\"Link\");\n      button.icon = linkIcon;\n      button.keystroke = LINK_KEYSTROKE;\n      button.tooltip = true;\n      button.withText = true;\n      button.isToggleable = true;\n\n      // Bind button to the command.\n      button.bind(\"isEnabled\").to(linkCommand, \"isEnabled\");\n      button.bind(\"isOn\").to(linkCommand, \"value\", (value) => !!value);\n\n      // Show the panel on button click.\n      this.listenTo(button, \"execute\", () => this._showUI(true));\n\n      return button;\n    });\n  }\n\n  _addFormView() {\n    super._addFormView();\n\n    const editor = this.editor;\n    const linkCommand = editor.commands.get(\"link\");\n\n    // Make sure that each time the panel shows up, all fields remain in sync\n    // with the values of the command.\n    this.formView.unbind(\"type\", \"params\");\n    this.formView.bind(\"type\", \"params\").to(linkCommand);\n    this.formView.updateValue();\n\n    // Select input when form view is currently visible.\n    if (this._balloon.visibleView === this.formView) {\n      this.formView.focus();\n    }\n  }\n}\n","import { Link } from \"@ckeditor/ckeditor5-link\";\n\nimport CustomAutoLink from \"./autolink\";\nimport CustomLinkEditing from \"./linkediting\";\nimport CustomLinkUI from \"./linkui\";\n\nexport default class CustomLink extends Link {\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [CustomLinkEditing, CustomLinkUI, CustomAutoLink];\n  }\n\n  static get pluginName() {\n    return \"CustomLink\";\n  }\n}\n","import { LinkImageEditing } from \"@ckeditor/ckeditor5-link\";\n\nimport CustomLinkEditing from \"./linkediting\";\n\nexport default class CustomLinkImageEditing extends LinkImageEditing {\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [\"ImageEditing\", \"ImageUtils\", CustomLinkEditing];\n  }\n\n  static get pluginName() {\n    return \"CustomLinkImageEditing\";\n  }\n}\n","import { LinkImageUI } from \"@ckeditor/ckeditor5-link\";\n\nimport CustomLinkEditing from \"./linkediting\";\nimport CustomLinkUI from \"./linkui\";\n\nexport default class CustomLinkImageUI extends LinkImageUI {\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [CustomLinkEditing, CustomLinkUI, \"ImageBlockEditing\"];\n  }\n\n  static get pluginName() {\n    return \"CustomLinkImageUI\";\n  }\n}\n","import { LinkImage } from \"@ckeditor/ckeditor5-link\";\n\nimport CustomLinkImageEditing from \"./linkimageediting\";\nimport CustomLinkImageUI from \"./linkimageui\";\n\nexport default class CustomLinkImage extends LinkImage {\n  static get pluginName() {\n    return \"CustomLinkImage\";\n  }\n\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [CustomLinkImageEditing, CustomLinkImageUI];\n  }\n}\n","export { default as CustomLink } from \"./link\";\nexport { default as CustomLinkEditing } from \"./linkediting.js\";\nexport { default as CustomLinkUI } from \"./linkui.js\";\nexport { default as CustomLinkImage } from \"./linkimage.js\";\nexport { default as CustomLinkImageEditing } from \"./linkimageediting.js\";\nexport { default as CustomLinkImageUI } from \"./linkimageui.js\";\nexport { default as CustomAutoLink } from \"./autolink.js\";\n\nexport { default as CustomLinkCommand } from \"./linkcommand.js\";\n","import { SourceEditing } from \"@ckeditor/ckeditor5-source-editing\";\n\nexport default class CustomSourceEditing extends SourceEditing {\n  _isAllowedToHandleSourceEditingMode() {\n    return true;\n  }\n}\n","export { default as CustomSourceEditing } from \"./sourceediting\";\n","import { useModule } from \"@metascore-library/core/services/module-manager\";\n\nexport default class Adapter {\n  constructor(loader) {\n    // The file loader instance to use during the upload.\n    this.loader = loader;\n  }\n\n  // Starts the upload process.\n  // @todo: handle uplaod progress\n  async upload() {\n    const { uploadFiles } = useModule(\"assets_library\");\n\n    const file = await this.loader.file;\n    const assets = await uploadFiles([file]);\n\n    return {\n      default: assets[0].url,\n    };\n  }\n}\n","import { Plugin } from \"@ckeditor/ckeditor5-core\";\nimport Adapter from \"./adapter\";\n\nexport default class UploadAdapter extends Plugin {\n  /**\n   * @inheritdoc\n   */\n  constructor(editor) {\n    super(editor);\n\n    editor.plugins.get(\"FileRepository\").createUploadAdapter = (loader) => {\n      return new Adapter(loader);\n    };\n  }\n}\n","export { default as UploadAdapter } from \"./uploadadapter\";\n","import { Alignment } from \"@ckeditor/ckeditor5-alignment\";\nimport { BlockQuote } from \"@ckeditor/ckeditor5-block-quote\";\nimport { Bold } from \"@ckeditor/ckeditor5-basic-styles\";\nimport { Essentials } from \"@ckeditor/ckeditor5-essentials\";\nimport { Font } from \"@ckeditor/ckeditor5-font\";\nimport { GeneralHtmlSupport } from \"@ckeditor/ckeditor5-html-support\";\nimport { Heading } from \"@ckeditor/ckeditor5-heading\";\nimport { Image } from \"@ckeditor/ckeditor5-image\";\nimport { ImageResize } from \"@ckeditor/ckeditor5-image\";\nimport { ImageStyle } from \"@ckeditor/ckeditor5-image\";\nimport { ImageTextAlternative } from \"@ckeditor/ckeditor5-image\";\nimport { ImageToolbar } from \"@ckeditor/ckeditor5-image\";\nimport { ImageUpload } from \"@ckeditor/ckeditor5-image\";\nimport { Indent } from \"@ckeditor/ckeditor5-indent\";\nimport { IndentBlock } from \"@ckeditor/ckeditor5-indent\";\nimport { Italic } from \"@ckeditor/ckeditor5-basic-styles\";\nimport { Link } from \"@ckeditor/ckeditor5-link\";\nimport { LinkUI } from \"@ckeditor/ckeditor5-link\";\nimport { AutoLink } from \"@ckeditor/ckeditor5-link\";\nimport { LinkEditing } from \"@ckeditor/ckeditor5-link\";\nimport { LinkImage } from \"@ckeditor/ckeditor5-link\";\nimport { LinkImageEditing } from \"@ckeditor/ckeditor5-link\";\nimport { List } from \"@ckeditor/ckeditor5-list\";\nimport { Paragraph } from \"@ckeditor/ckeditor5-paragraph\";\nimport { RemoveFormat } from \"@ckeditor/ckeditor5-remove-format\";\nimport { SourceEditing } from \"@ckeditor/ckeditor5-source-editing\";\nimport { SpecialCharacters } from \"@ckeditor/ckeditor5-special-characters\";\nimport { SpecialCharactersEssentials } from \"@ckeditor/ckeditor5-special-characters\";\nimport { Strikethrough } from \"@ckeditor/ckeditor5-basic-styles\";\nimport { Subscript } from \"@ckeditor/ckeditor5-basic-styles\";\nimport { Superscript } from \"@ckeditor/ckeditor5-basic-styles\";\nimport { Table } from \"@ckeditor/ckeditor5-table\";\nimport { TableToolbar } from \"@ckeditor/ckeditor5-table\";\nimport { Underline } from \"@ckeditor/ckeditor5-basic-styles\";\n\nimport { BehaviorTrigger } from \"./plugins/ckeditor5-behaviortrigger/src\";\nimport { CustomLink, CustomLinkImage } from \"./plugins/ckeditor5-link/src\";\nimport { CustomSourceEditing } from \"./plugins/ckeditor5-sourceediting/src\";\nimport { UploadAdapter } from \"./plugins/ckeditor5-uploadadapter/src\";\n\nimport { DecoupledEditor } from \"@ckeditor/ckeditor5-editor-decoupled\";\n\nimport \"./styles.scss\";\n\nexport default function createEditor(\n  el,\n  { language = \"fr\", extraFonts = [] } = {}\n) {\n  return DecoupledEditor.create(el, {\n    language,\n    removePlugins: [\n      Link,\n      AutoLink,\n      LinkEditing,\n      LinkUI,\n      LinkImage,\n      LinkImageEditing,\n      SourceEditing,\n    ],\n    plugins: [\n      Alignment,\n      BehaviorTrigger,\n      BlockQuote,\n      Bold,\n      Essentials,\n      Font,\n      GeneralHtmlSupport,\n      Heading,\n      Image,\n      ImageResize,\n      ImageStyle,\n      ImageTextAlternative,\n      ImageToolbar,\n      ImageUpload,\n      Indent,\n      IndentBlock,\n      Italic,\n      CustomLink,\n      CustomLinkImage,\n      List,\n      Paragraph,\n      RemoveFormat,\n      CustomSourceEditing,\n      SpecialCharacters,\n      SpecialCharactersEssentials,\n      Strikethrough,\n      Subscript,\n      Superscript,\n      Table,\n      TableToolbar,\n      Underline,\n      UploadAdapter,\n    ],\n    toolbar: {\n      items: [\n        \"undo\",\n        \"redo\",\n        \"|\",\n        \"bold\",\n        \"italic\",\n        \"underline\",\n        \"strikethrough\",\n        \"subscript\",\n        \"superscript\",\n        \"|\",\n        \"heading\",\n        \"blockQuote\",\n        \"removeFormat\",\n        \"|\",\n        \"fontFamily\",\n        \"fontSize\",\n        \"fontColor\",\n        \"fontBackgroundColor\",\n        \"|\",\n        \"numberedList\",\n        \"bulletedList\",\n        \"outdent\",\n        \"indent\",\n        \"|\",\n        \"alignment\",\n        \"|\",\n        \"uploadImage\",\n        \"insertTable\",\n        \"specialCharacters\",\n        \"-\",\n        \"link\",\n        \"addBehaviorTrigger\",\n        \"|\",\n        \"sourceEditing\",\n      ],\n      shouldNotGroupWhenFull: true,\n    },\n    heading: {\n      options: [\n        { model: \"paragraph\", title: \"Paragraph\" },\n        { model: \"heading1\", view: \"h1\", title: \"Heading 1\" },\n        { model: \"heading2\", view: \"h2\", title: \"Heading 2\" },\n        { model: \"heading3\", view: \"h3\", title: \"Heading 3\" },\n        { model: \"heading4\", view: \"h4\", title: \"Heading 4\" },\n        { model: \"heading5\", view: \"h5\", title: \"Heading 5\" },\n        { model: \"heading6\", view: \"h6\", title: \"Heading 6\" },\n        { model: \"div\", view: \"div\", title: \"Division\" },\n        { model: \"pre\", view: \"pre\", title: \"Preformatted\" },\n        { model: \"address\", view: \"address\", title: \"Address\" },\n      ],\n    },\n    fontFamily: {\n      options: [\n        \"default\",\n        ...extraFonts,\n        \"Arial, Helvetica, sans-serif\",\n        \"Courier New, Courier, monospace\",\n        \"Georgia, serif\",\n        \"Lucida Sans Unicode, Lucida Grande, sans-serif\",\n        \"Tahoma, Geneva, sans-serif\",\n        \"Times New Roman, Times, serif\",\n        \"Trebuchet MS, Helvetica, sans-serif\",\n        \"Verdana, Geneva, sans-serif\",\n      ],\n      supportAllValues: true,\n    },\n    fontSize: {\n      options: [\n        \"default\",\n        8,\n        9,\n        10,\n        11,\n        12,\n        14,\n        16,\n        18,\n        20,\n        22,\n        24,\n        26,\n        28,\n        36,\n        48,\n        72,\n      ],\n      supportAllValues: true,\n    },\n    image: {\n      toolbar: [\n        \"linkImage\",\n        \"|\",\n        \"imageStyle:inline\",\n        \"imageStyle:block\",\n        \"imageStyle:side\",\n        \"|\",\n        \"imageTextAlternative\",\n      ],\n    },\n    table: {\n      contentToolbar: [\"tableColumn\", \"tableRow\", \"mergeTableCells\"],\n    },\n    htmlSupport: {\n      allow: [\n        {\n          name: /^(div|a|p|i|em|b|strong|h[1-6]|span|big|small|q|cite|ins|del|var|samp|kbd|code|tt)$/,\n          classes: true,\n          styles: true,\n          attributes: {\n            dir: /^(rtl|ltr)$/,\n          },\n        },\n        {\n          name: \"a\",\n          attributes: {\n            target: \"_blank\",\n            rel: /^(noopener|nofollow)$/,\n          },\n        },\n      ],\n      disallow: [],\n    },\n    updateSourceElementOnDestroy: true,\n  });\n}\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xml:space=\\\"preserve\\\" viewBox=\\\"0 0 22 22\\\">\\n  <path d=\\\"M12.069 13.455c.308.307.338.781.063 1.055l-4.555 4.553c-.271.271-.747.244-1.053-.064l-3.526-3.523c-.306-.309-.334-.781-.063-1.055L7.49 9.867c.272-.272.747-.243 1.053.063.307.306.337.781.064 1.053l-3.564 3.565c-.272.271-.245.746.063 1.053l1.29 1.291c.308.307.782.334 1.055.064l3.563-3.564c.274-.273.748-.246 1.055.063M19 6.526c.307.306.336.78.063 1.053l-4.554 4.554c-.27.271-.747.244-1.054-.063-.307-.308-.336-.782-.065-1.055l3.565-3.563c.273-.272.243-.747-.063-1.053l-1.29-1.291c-.307-.308-.78-.337-1.053-.064l-3.566 3.563c-.271.273-.746.244-1.053-.063-.307-.306-.335-.781-.064-1.052l4.555-4.555c.271-.272.747-.243 1.053.063L19 6.526z\\\"/>\\n  <path d=\\\"M14.217 7.783c.31.308.338.78.063 1.053l-5.446 5.445c-.27.271-.745.242-1.053-.064-.306-.305-.335-.781-.063-1.053l5.446-5.444c.272-.274.747-.245 1.053.063M19.035 19.465 17.48 21.02a.824.824 0 1 1-1.207-1.125l.041-.041 1.555-1.557-1.557-1.555a.824.824 0 0 1 1.166-1.166l1.556 1.555 1.557-1.557a.825.825 0 1 1 1.166 1.168l-1.555 1.555 1.555 1.557a.824.824 0 1 1-1.166 1.166l-1.556-1.555z\\\"/>\\n</svg>\\n\";"],"names":["AutomaticDecorators","_classCallCheck","_definitions","Set","_createClass","key","get","size","value","add","item","_this","Array","isArray","forEach","getDispatcher","_this2","dispatcher","on","evt","data","conversionApi","consumable","test","is","schema","isInline","viewWriter","writer","viewSelection","document","selection","_iterator","_createForOfIteratorHelper","_step","s","n","done","viewElement","createAttributeElement","attributes","priority","classes","addClass","styles","setStyle","setCustomProperty","callback","attributeNewValue","wrap","getFirstRange","mapper","toViewRange","range","unwrap","err","e","f","default","upperFirst","TRIGGER_KEYSTROKE","isLinkElement","node","getCustomProperty","createBehaviorTriggerElement","id","_ref","behaviorTriggerElement","normalizeDecorators","decorators","retArray","_i","_Object$entries","Object","entries","length","_Object$entries$_i","_slicedToArray","decorator","assign","push","isTriggerableElement","element","checkAttribute","name","Command","findAttributeRange","Collection","first","toMap","AddBehaviorTriggerCommand","_Command","_inherits","editor","_callSuper","manualDecorators","automaticDecorators","restoreManualDecoratorStates","manualDecorator","_getDecoratorStateFromModel","refresh","model","selectedElement","getSelectedElement","getSelectedBlocks","getAttribute","isEnabled","checkAttributeInSelection","_iterator2","_step2","execute","manualDecoratorIds","arguments","undefined","truthyManualDecorators","falsyManualDecorators","change","isCollapsed","position","getFirstPosition","hasAttribute","linkRange","setAttribute","removeAttribute","setSelection","createPositionAfter","end","nodeBefore","getAttributes","set","_model$insertContent","insertContent","createText","positionAfter","concat","removeSelectionAttribute","ranges","getValidRanges","getRanges","allowedRanges","_iterator3","_step3","createRangeOn","rangesToUpdate","slice","_iterator4","_step4","_isRangeToUpdate","_iterator5","_step5","_loop","decoratorName","_iterator6","_step6","allowedRange","containsRange","RemoveBehaviorTriggerCommand","addBehaviorTriggerCommand","commands","rangesToUnlink","Plugin","MouseObserver","Input","TwoStepCaretMovement","inlineHighlight","ClipboardPipeline","keyCodes","HIGHLIGHT_CLASS","BehaviorTriggerEditing","_Plugin","init","extend","allowAttributes","conversion","for","attributeToElement","view","elementToAttribute","twoStepCaretMovementPlugin","plugins","registerAttribute","_enableInsertContentSelectionAttributesFixer","_enableClickingAfterLink","_enableTypingOverLink","_handleDeleteContentAfterLink","listenTo","anchor","nodeAfter","removeLinkAttributesFromSelection","getLinkAttributesAllowedOnText","editing","addObserver","clicked","isTouching","start","selectionAttributes","deletedContent","isTyping","shouldCopyAttributes","_ref2","_step$value","attribute","shouldPreserveAttributes","hasBackspacePressed","domEvent","keyCode","backspace","behaviorTrigger","containsPosition","isEqual","enqueueChange","linkAttributes","firstPosition","lastPosition","getLastPosition","nodeAtFirstPosition","nodeAtLastPosition","textNode","createRange","currentBatch","batch","textAttributes","getDefinition","filter","startsWith","ButtonView","FocusCycler","LabeledFieldView","SwitchButtonView","View","ViewCollection","createLabeledInputText","submitHandler","FocusTracker","KeystrokeHandler","icons","BehaviorTriggerFormView","_View","locale","t","focusTracker","keystrokes","idInputView","_createIdInput","saveButtonView","_createButton","check","type","cancelButtonView","cancel","_manualDecoratorSwitches","_createManualDecoratorSwitches","children","_createFormChildren","_focusables","_focusCycler","focusables","keystrokeHandler","actions","focusPrevious","focusNext","classList","setTemplate","tag","class","tabindex","getDecoratorSwitchesState","from","reduce","accumulator","switchButton","isOn","render","_get","_getPrototypeOf","prototype","call","childViews","_toConsumableArray","v","destroy","focus","focusFirst","labeledInput","label","icon","className","eventName","button","tooltip","extendTemplate","delegate","to","_this3","switches","createCollection","withText","bind","toMany","decoratorValue","commandValue","defaultValue","additionalButtonsView","map","LabelView","removeBehaviorTriggerIcon","BehaviorTriggerActionsView","previewLabelView","_createPreviewLabel","removeTriggerButtonView","editButtonView","pencil","ClickObserver","ContextualBalloon","clickOutsideHandler","CssTransitionDisablerMixin","isWidget","viewToPlainText","addBehaviorTriggerIcon","VISUAL_SELECTION_MARKER_NAME","BehaviorTriggerUI","actionsView","_createActionsView","formView","_createFormView","_balloon","_createToolbarAddButton","_enableUserBalloonInteractions","markerToHighlight","markerToElement","removeBehaviorTriggerCommand","_addFormView","_hideUI","fieldView","_closeFormView","keyEvtData","_showUI","ui","componentFactory","keystroke","isToggleable","_this4","viewDocument","parentLink","_getSelectedLinkElement","_areActionsVisible","isFocused","_isUIVisible","emitter","activator","_isUIInPanel","contextElements","_addActionsView","_areActionsInPanel","_getBalloonPositionData","_isFormInPanel","disableCssTransitions","visibleView","select","enableCssTransitions","_generateIdFromSelection","_removeFormView","remove","_hideFakeVisualSelection","forceVisible","_showFakeVisualSelection","showStack","_startUpdatingUI","stopListening","_this5","prevSelectedLink","prevSelectionParent","getSelectionParent","update","selectedLink","selectionParent","updatePosition","getAncestors","reverse","find","hasView","_this6","target","markers","has","markerViewElements","markerNameToElements","newRange","createPositionBefore","domConverter","viewRangeToDom","targetLink","mapViewToDom","findLinkElementAncestor","getTrimmed","startLink","endLink","createRangeIn","updateMarker","isAtEnd","startPosition","getLastMatchingPosition","isContent","boundaries","addMarker","usingOperation","affectsData","removeMarker","getItems","replace","substring","trim","toLowerCase","ancestor","BehaviorTrigger","LinkCommand","omit","useModule","CustomLinkCommand","_LinkCommand","params","_useModule","getLinkActions","action","index","LinkEditing","CustomLinkEditing","_LinkEditing","AutoLink","CustomAutoLink","_AutoLink","InputView","InputTimecodeView","_InputView","min","max","bindTemplate","inputMode","template","_updateIsEmpty","isEmpty","ViewModel","createLabeledInputTimecode","labeledFieldView","viewUid","statusUid","inputView","ariaDescribedById","errorText","getTypeLabels","play","pause","stop","seek","page","toggle","scenario","fullscreen","url","getComponentLabels","getComponentsByType","labels","c","getToggleActionLabels","show","hide","getFullscreenActionLabels","enter","exit","getDropdownDefinitions","itemDefinitions","definition","_value","FormGroupView","options","child","if","role","ToolbarView","unref","clearIcon","inIcon","outIcon","LabeledTimecodeFieldView","_LabeledFieldView","_ref$in_button","in_button","_ref$out_button","out_button","_ref$clear_button","clear_button","mediaTime","time","seekMediaTo","seekTo","toolbarView","buttons","inButton","fire","outButton","clearButton","items","addMany","fieldWrapperChildren","LinkFormView","createLabeledDropdown","createLabeledInputNumber","addListToDropdown","tipIcon","CustomLinkFormView","_LinkFormView","linkCommand","urlInputView","updateValue","placeholder","extraChildViews","typeInputView","_playInputsGroup","_seekInputsGroup","_pageInputsGroup","_blockToggleInputsGroup","_scenarioInputsGroup","_fullscreenInputsGroup","_createTypeInput","typeLabels","dropdown","buttonView","source","dropdownDefinitions","_createUrlInput","_createPlayInputs","playExcerptInputView","excerpt","_this4$params","_objectSpread","playStartInputView","playEndInputView","scenarioLabels","playScenarioInputView","playHighlightInputView","highlight","_this4$params2","inputs","_createSeekInputs","seekTimeInputView","_createPageInputs","blockLabels","fromEntries","values","val","pageBlockInputView","block","pageIndexInputView","step","parseInt","_createBlockToggleInputs","_this7","toggleBlockInputView","nameDropdownDefinitions","actionLabels","toggleActionInputView","actionDropdownDefinitions","_createScenarioInputs","_this8","scenarioScenarioInputView","idDropdownDefinitions","_createFullscreenInputs","_this9","fullscreenActionInputView","_createTipView","_tipView","_params$start","_params$end","_params$scenario","LinkUI","addLinkProtocolIfApplicable","LINK_KEYSTROKE","linkIcon","CustomLinkUI","_LinkUI","defaultProtocol","config","allowCreatingEmptyLinks","isCommandEnabled","isInputEmpty","parsedUrl","_createToolbarLinkButton","unbind","Link","CustomLink","_Link","LinkImageEditing","CustomLinkImageEditing","_LinkImageEditing","LinkImageUI","CustomLinkImageUI","_LinkImageUI","LinkImage","CustomLinkImage","_LinkImage","SourceEditing","CustomSourceEditing","_SourceEditing","_isAllowedToHandleSourceEditingMode","Adapter","loader","_upload","_asyncToGenerator","_regeneratorRuntime","mark","_callee","uploadFiles","file","assets","_callee$","_context","prev","next","sent","abrupt","upload","apply","UploadAdapter","createUploadAdapter","Alignment","BlockQuote","Bold","Essentials","Font","GeneralHtmlSupport","Heading","Image","ImageResize","ImageStyle","ImageTextAlternative","ImageToolbar","ImageUpload","Indent","IndentBlock","Italic","List","Paragraph","RemoveFormat","SpecialCharacters","SpecialCharactersEssentials","Strikethrough","Subscript","Superscript","Table","TableToolbar","Underline","DecoupledEditor","createEditor","el","_ref$language","language","_ref$extraFonts","extraFonts","create","removePlugins","toolbar","shouldNotGroupWhenFull","heading","title","fontFamily","supportAllValues","fontSize","image","table","contentToolbar","htmlSupport","allow","dir","rel","disallow","updateSourceElementOnDestroy"],"sourceRoot":""}