{"version":3,"file":"metaScore.Player.umd.773.js","mappings":"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","sources":["webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/app.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/utils.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/components.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/keyboard.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/links.js","webpack://metaScore/./node_modules/@blockly/block-plus-minus/src/serialization_helper.js","webpack://metaScore/./node_modules/@blockly/block-plus-minus/src/field_minus.js","webpack://metaScore/./node_modules/@blockly/block-plus-minus/src/field_plus.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/media.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/reactivity.js","webpack://metaScore/./packages/core/modules/app_behaviors/blockly/blocks/index.js"],"sourcesContent":["import { defineBlocksWithJsonArray } from \"blockly/core\";\n\ndefineBlocksWithJsonArray([\n  {\n    type: \"app_startup\",\n    message0: \"%{BKY_APP_STARTUP}\",\n    message1: \"%{BKY_APP_STARTUP_THEN}\",\n    args1: [\n      {\n        type: \"input_statement\",\n        name: \"STATEMENT\",\n      },\n    ],\n    style: \"trigger_blocks\",\n    tooltip: \"%{BKY_APP_STARTUP_TOOLTIP}\",\n    helpUrl: \"%{BKY_APP_STARTUP_HELPURL}\",\n  },\n  {\n    type: \"app_enter_fullscreen\",\n    message0: \"%{BKY_APP_ENTER_FULLSCREEN}\",\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_APP_ENTER_FULLSCREEN_TOOLTIP}\",\n    helpUrl: \"%{BKY_APP_ENTER_FULLSCREEN_HELPURL}\",\n  },\n  {\n    type: \"app_exit_fullscreen\",\n    message0: \"%{BKY_APP_EXIT_FULLSCREEN}\",\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_APP_EXIT_FULLSCREEN_TOOLTIP}\",\n    helpUrl: \"%{BKY_APP_EXIT_FULLSCREEN_HELPURL}\",\n  },\n  {\n    type: \"app_toggle_fullscreen\",\n    message0: \"%{BKY_APP_TOGGLE_FULLSCREEN}\",\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_APP_TOGGLE_FULLSCREEN_TOOLTIP}\",\n    helpUrl: \"%{BKY_APP_TOGGLE_FULLSCREEN_HELPURL}\",\n  },\n]);\n","import { watch } from \"vue\";\nimport { UnattachedFieldError } from \"blockly/core\";\n\n/**\n * Update a dropdown field's options and value depending on an options ref.\n * @param {*} field The dropdown field\n * @param {*} optionsRef The options ref\n */\nexport function watchDrowpdownFieldOptions(field, optionsRef) {\n  const block = field.getSourceBlock();\n  if (!block) throw new UnattachedFieldError();\n\n  const unwatch = watch(optionsRef, (newOptions) => {\n    // Update the field's dropdown list and value when new options are available.\n    const oldValue = field.getValue();\n    const newOptionsIncludeOldValue =\n      newOptions.find((option) => option[1] == oldValue) != undefined;\n    const newValue = newOptionsIncludeOldValue ? oldValue : newOptions[0][1];\n    field.getOptions(false);\n    field.setValue(newValue);\n  });\n\n  const origDestroy = block.destroy;\n  block.destroy = () => {\n    if (typeof origDestroy === \"function\") origDestroy();\n    unwatch();\n  };\n}\n","import { ref, watchEffect } from \"vue\";\nimport { defineBlocksWithJsonArray, Extensions, Msg, Css } from \"blockly/core\";\nimport FieldDropdown from \"../core/field_dropdown\";\nimport { useModule } from \"@metascore-library/core/services/module-manager\";\nimport { EMPTY_OPTION } from \"../constants\";\nimport { watchDrowpdownFieldOptions } from \"../utils\";\n\nconst BREADCRUMB_SEPARATOR = \" â€º \";\n\nconst SUPPORTED_PROPERTIES = [\n  \"background-color\",\n  \"border-color\",\n  \"border-width\",\n  \"hidden\",\n  \"loop-duration\",\n  \"reversed\",\n  \"cursor-width\",\n  \"cursor-color\",\n];\n\n/**\n * Get component dropdown options\n * @param {array} components The components\n * @param {boolean} recursive Whether to recurse to child components.\n * @param {number} level_ The current recursion level, used internally.\n * @param {string} breadcrumb_ The current recursion breadcrumb, used internally.\n * @returns {array} An options array\n */\nfunction getComponentOptions(\n  components = [],\n  recursive = false,\n  level_ = 0,\n  breadcrumb_ = \"\"\n) {\n  const { getComponentChildren, getComponentLabel, getComponentIconURL } =\n    useModule(\"app_components\");\n  let options = [];\n\n  if (components.length > 0) {\n    components.forEach((c) => {\n      const name = getComponentLabel(c);\n      let label = name;\n\n      const icon_url = getComponentIconURL(c);\n      if (icon_url) {\n        label = document.createElement(\"div\");\n        label.classList.add(\"blocklyMenuItemLabel\");\n        if (level_) {\n          label.style.setProperty(\"--level\", level_);\n        }\n\n        const icon = document.createElement(\"img\");\n        icon.src = icon_url;\n        icon.classList.add(\"blocklyMenuItemLabelIcon\");\n        label.appendChild(icon);\n\n        const text = document.createElement(\"div\");\n        text.classList.add(\"blocklyMenuItemLabelText\");\n        text.appendChild(document.createTextNode(name));\n        label.appendChild(text);\n\n        if (breadcrumb_) {\n          const breadcrumb = document.createElement(\"div\");\n          breadcrumb.classList.add(\"blocklyMenuItemLabelBreadcrumb\");\n          breadcrumb.appendChild(document.createTextNode(breadcrumb_));\n          label.appendChild(breadcrumb);\n        }\n\n        label.setAttribute(\n          \"title\",\n          breadcrumb_ ? `${breadcrumb_}${BREADCRUMB_SEPARATOR}${name}` : name\n        );\n      }\n\n      const option = [{ label, text: name }, `${c.type}:${c.id}`];\n\n      options.push(option);\n\n      if (recursive) {\n        const children = getComponentChildren(c);\n        if ([\"Scenario\", \"Page\"].includes(c.type)) {\n          children.reverse();\n        }\n\n        options = [\n          ...options,\n          ...getComponentOptions(\n            children,\n            true,\n            level_ + 1,\n            level_ > 0 ? `${breadcrumb_}${BREADCRUMB_SEPARATOR}${name}` : name\n          ),\n        ];\n      }\n    });\n  }\n\n  return options;\n}\n\n/**\n * Get the options array for the PROPERTY field.\n * @param {string} component_type The component type.\n * @returns {array} The options.\n */\nfunction getPropertyOptions(component_type) {\n  if (component_type === EMPTY_OPTION) {\n    return [\n      [Msg.COMPONENTS_EMPTY_OPTION, EMPTY_OPTION],\n      // Add all supported properties\n      // to prevent validation issues.\n      ...SUPPORTED_PROPERTIES.map((property) => {\n        return [Msg.COMPONENTS_PROPERTY[property], property];\n      }),\n    ];\n  }\n\n  const { getModelByType } = useModule(\"app_components\");\n  return Object.keys(getModelByType(component_type).properties)\n    .filter((property) => {\n      return SUPPORTED_PROPERTIES.includes(property);\n    })\n    .map((property) => {\n      return [Msg.COMPONENTS_PROPERTY[property], property];\n    });\n}\n\nconst scenarioOptions = ref([]);\nwatchEffect(() => {\n  const { getComponentsByType } = useModule(\"app_components\");\n  scenarioOptions.value = getComponentOptions(getComponentsByType(\"Scenario\"));\n});\nExtensions.register(\"components_scenario_options\", function () {\n  const scenario_input = this.getInput(\"COMPONENT\");\n  if (!scenario_input) return;\n\n  const scenario_field = new FieldDropdown(\n    function () {\n      const options = scenarioOptions.value;\n\n      if (options.length === 0) {\n        const block = this.getSourceBlock();\n        if (block) {\n          block.setEnabled(false);\n          block.setTooltip(Msg.COMPONENTS_NO_SCENARIO_TOOLTIP);\n        }\n        this.setEnabled(false);\n        return [[Msg.COMPONENTS_EMPTY_OPTION, EMPTY_OPTION]];\n      }\n\n      return options;\n    },\n    null,\n    { searchable: true }\n  );\n  scenario_input.appendField(scenario_field, \"COMPONENT\");\n\n  // Update the field's dropdown list and value when new options are available.\n  watchDrowpdownFieldOptions(scenario_field, scenarioOptions);\n});\n\nconst blockOptions = ref([]);\nwatchEffect(() => {\n  const { getComponentsByType } = useModule(\"app_components\");\n  blockOptions.value = getComponentOptions(getComponentsByType(\"Block\"));\n});\nExtensions.register(\"components_block_options\", function () {\n  const block_input = this.getInput(\"COMPONENT\");\n  if (!block_input) return;\n\n  const block_field = new FieldDropdown(\n    function () {\n      const options = blockOptions.value;\n\n      if (options.length === 0) {\n        const block = this.getSourceBlock();\n        if (block) {\n          block.setEnabled(false);\n          block.setTooltip(Msg.COMPONENTS_NO_BLOCK_TOOLTIP);\n        }\n        this.setEnabled(false);\n        return [[Msg.COMPONENTS_EMPTY_OPTION, EMPTY_OPTION]];\n      }\n\n      return options;\n    },\n    null,\n    { searchable: true }\n  );\n  block_input.appendField(block_field, \"COMPONENT\");\n\n  // Update the field's dropdown list and value when new options are available.\n  watchDrowpdownFieldOptions(block_field, blockOptions);\n});\n\nconst componentOptions = ref([]);\nwatchEffect(() => {\n  const { getComponentsByType } = useModule(\"app_components\");\n  componentOptions.value = getComponentOptions(\n    getComponentsByType(\"Scenario\"),\n    true\n  );\n});\nExtensions.register(\"components_component_options\", function () {\n  const component_input = this.getInput(\"COMPONENT\");\n  if (!component_input) return;\n\n  const mock = this.type.endsWith(\"_mock\");\n\n  const component_field = new FieldDropdown(\n    function () {\n      const empty_option = [\n        {\n          label: Msg.COMPONENTS_EMPTY_OPTION,\n          default: true,\n          hidden: true,\n        },\n        EMPTY_OPTION,\n      ];\n\n      if (mock) return [empty_option];\n\n      return [empty_option, ...componentOptions.value];\n    },\n    null,\n    { searchable: true }\n  );\n  component_input.appendField(component_field, \"COMPONENT\");\n\n  // Update the field's dropdown list and value when new options are available.\n  watchDrowpdownFieldOptions(component_field, componentOptions);\n\n  if (mock) {\n    component_field.setEnabled(false);\n\n    this.setEnabled(false);\n    this.setTooltip(() => {\n      return Msg.COMPONENTS_PROPERTY_MOCK_TOOLTIP.replace(\n        \"%2\",\n        Msg.COMPONENTS_PROPERTY[this.property_]\n      );\n    });\n  }\n});\n\nExtensions.register(\"components_property_options\", function () {\n  const property_input = this.getInput(\"PROPERTY\");\n  if (!property_input) return;\n\n  const mock = this.type.endsWith(\"_mock\");\n\n  const property_field = new FieldDropdown(function () {\n    const block = this.getSourceBlock();\n\n    if (!block || mock) {\n      if (block && block.property_) {\n        return [[Msg.COMPONENTS_PROPERTY[block.property_], block.property_]];\n      }\n      return [[Msg.COMPONENTS_EMPTY_OPTION, EMPTY_OPTION]];\n    }\n\n    const component_value = block.getFieldValue(\"COMPONENT\");\n    const component_type = block.getComponentType_(component_value);\n    return getPropertyOptions(component_type);\n  });\n  property_input.appendField(property_field, \"PROPERTY\");\n\n  if (mock) {\n    property_field.setEnabled(false);\n  }\n});\n\nconst PROPERTY_OPTIONS_MUTATOR_MIXIN = {\n  /**\n   * Returns the state of this block as a JSON serializable object.\n   * @return {?{elseIfCount: (number|undefined), haseElse: (boolean|undefined)}}\n   *     The state of this block.\n   */\n  saveExtraState: function () {\n    const property_input = this.getInput(\"PROPERTY\");\n    if (property_input) {\n      return {\n        property: this.getFieldValue(\"PROPERTY\"),\n      };\n    }\n\n    return null;\n  },\n\n  /**\n   * Applies the given state to this block.\n   * @param {*} state The state to apply to this block.\n   */\n  loadExtraState: function (state) {\n    const property_input = this.getInput(\"PROPERTY\");\n    if (property_input) {\n      this.property_ = state[\"property\"];\n    }\n  },\n\n  /**\n   * Callback called whenever the block's parent workspace changes.\n   * @param {object} evt The event.\n   */\n  onchange: function (evt) {\n    switch (evt.type) {\n      case \"create\":\n        this.updatePropertyField_();\n        break;\n\n      case \"change\":\n        if (evt.element === \"field\") {\n          if (evt.name === \"COMPONENT\") {\n            const newType = this.getComponentType_(evt.newValue);\n            const oldType = this.getComponentType_(evt.oldValue);\n\n            // Type didn't change, skip update.\n            if (newType === oldType) return;\n\n            this.updatePropertyField_();\n          } else if (evt.name === \"PROPERTY\") {\n            this.property_ = evt.newValue;\n            this.updateChecks_();\n          }\n        }\n        break;\n    }\n  },\n\n  /**\n   * Parse the component type from a COMPONENT field value.\n   * @param {string?} component_value The value to parse, the current field value is used if null.\n   * @returns {string?} The component id or null if the value counldn't be parsed.\n   */\n  getComponentType_: function (component_value) {\n    if (typeof component_value === \"undefined\") {\n      component_value = this.getFieldValue(\"COMPONENT\");\n    }\n\n    if (!component_value) return null;\n\n    const [type] = component_value.split(\":\");\n    return type;\n  },\n\n  /**\n   * Get the compatible value type or list of value types for the VALUE input.\n   * @param {string} component_type The component type.\n   * @param {string} property_name The property's name.\n   * @returns {string|array<string>|null} The type check.\n   */\n  getPropertyValueTypeCheck_: function (component_type, property_name) {\n    if (component_type === EMPTY_OPTION) return null;\n\n    const { getModelByType } = useModule(\"app_components\");\n    const property = getModelByType(component_type).properties?.[property_name];\n\n    if (property) {\n      const format = property.format;\n      switch (format) {\n        case \"color\":\n          return \"Colour\";\n      }\n\n      const type = Array.isArray(property.type)\n        ? property.type.find((t) => t !== \"null\")\n        : property.type;\n\n      switch (type) {\n        case \"boolean\":\n          return \"Boolean\";\n        case \"number\":\n        case \"integer\":\n          return \"Number\";\n        case \"string\":\n          return \"String\";\n      }\n    }\n\n    return null;\n  },\n\n  /**\n   * Update the PROPERTY field.\n   */\n  updatePropertyField_: function () {\n    const property_field = this.getField(\"PROPERTY\");\n    if (!property_field) return;\n\n    const options = property_field.getOptions(false);\n    const match = options.find((o) => {\n      return o[1] === this.property_;\n    });\n    property_field.setValue(match ? this.property_ : options[0][1]);\n  },\n\n  /**\n   * Update the output or VALUE field's check.\n   */\n  updateChecks_() {\n    const mock = this.type.endsWith(\"_mock\");\n    if (mock) return;\n\n    const component_type = this.getComponentType_();\n    const property_value = this.getFieldValue(\"PROPERTY\");\n    const type = this.getPropertyValueTypeCheck_(\n      component_type,\n      property_value\n    );\n\n    const value_input = this.getInput(\"VALUE\");\n    if (value_input) {\n      value_input.setCheck(type);\n    } else if (this.outputConnection) {\n      this.outputConnection.setCheck(type);\n    }\n  },\n};\n\nExtensions.registerMutator(\n  \"components_property_options_mutator\",\n  PROPERTY_OPTIONS_MUTATOR_MIXIN\n);\n\ndefineBlocksWithJsonArray([\n  // Click.\n  {\n    type: \"components_click\",\n    message0: \"%{BKY_COMPONENTS_CLICK}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n    ],\n    message1: \"%{BKY_COMPONENTS_CLICK_THEN}\",\n    args1: [\n      {\n        type: \"input_statement\",\n        name: \"STATEMENT\",\n      },\n    ],\n    extensions: [\"components_component_options\"],\n    inputsInline: true,\n    style: \"trigger_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_CLICK_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_CLICK_HELPURL}\",\n  },\n  // Set scenario.\n  {\n    type: \"components_set_scenario\",\n    message0: \"%{BKY_COMPONENTS_SET_SCENARIO}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n    ],\n    extensions: [\"components_scenario_options\"],\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_SET_SCENARIO_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_SET_SCENARIO_HELPURL}\",\n  },\n  // Get property.\n  {\n    type: \"components_get_property\",\n    message0: \"%{BKY_COMPONENTS_GET_PROPERTY}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n      {\n        type: \"input_dummy\",\n        name: \"PROPERTY\",\n      },\n    ],\n    extensions: [\"components_component_options\", \"components_property_options\"],\n    mutator: \"components_property_options_mutator\",\n    inputsInline: true,\n    output: null,\n    style: \"component_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_GET_PROPERTY_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_GET_PROPERTY_HELPURL}\",\n  },\n  // Get property mock.\n  {\n    type: \"components_get_property_mock\",\n    message0: \"%{BKY_COMPONENTS_GET_PROPERTY}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n      {\n        type: \"input_dummy\",\n        name: \"PROPERTY\",\n      },\n    ],\n    extensions: [\"components_component_options\", \"components_property_options\"],\n    mutator: \"components_property_options_mutator\",\n    inputsInline: true,\n    output: null,\n    style: \"component_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_GET_PROPERTY_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_GET_PROPERTY_HELPURL}\",\n  },\n  // Set property.\n  {\n    type: \"components_set_property\",\n    message0: \"%{BKY_COMPONENTS_SET_PROPERTY}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n      {\n        type: \"input_dummy\",\n        name: \"PROPERTY\",\n      },\n      {\n        type: \"input_value\",\n        name: \"VALUE\",\n      },\n    ],\n    extensions: [\"components_component_options\", \"components_property_options\"],\n    mutator: \"components_property_options_mutator\",\n    inputsInline: true,\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_SET_PROPERTY_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_SET_PROPERTY_HELPURL}\",\n  },\n  // Set property mock.\n  {\n    type: \"components_set_property_mock\",\n    message0: \"%{BKY_COMPONENTS_SET_PROPERTY}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n      {\n        type: \"input_dummy\",\n        name: \"PROPERTY\",\n      },\n      {\n        type: \"input_value\",\n        name: \"VALUE\",\n      },\n    ],\n    extensions: [\"components_component_options\", \"components_property_options\"],\n    mutator: \"components_property_options_mutator\",\n    inputsInline: true,\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_SET_PROPERTY_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_SET_PROPERTY_HELPURL}\",\n  },\n  // Get block's activate page index.\n  {\n    type: \"components_get_block_page\",\n    message0: \"%{BKY_COMPONENTS_GET_BLOCK_PAGE}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n    ],\n    extensions: [\"components_block_options\"],\n    output: \"Number\",\n    style: \"component_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_GET_BLOCK_PAGE_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_GET_BLOCK_PAGE_HELPURL}\",\n  },\n  // Set block's activate page index.\n  {\n    type: \"components_set_block_page\",\n    message0: \"%{BKY_COMPONENTS_SET_BLOCK_PAGE}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"COMPONENT\",\n      },\n      {\n        type: \"input_value\",\n        name: \"INDEX\",\n        check: \"Number\",\n      },\n    ],\n    extensions: [\"components_block_options\"],\n    inputsInline: true,\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_COMPONENTS_SET_BLOCK_PAGE_TOOLTIP}\",\n    helpUrl: \"%{BKY_COMPONENTS_SET_BLOCK_PAGE_HELPURL}\",\n  },\n]);\n\nCss.register(\n  `\n  .blocklyDropDownDiv .blocklyMenuItemLabel {\n    display: grid;\n    grid-template-columns: auto 1fr;\n    grid-template-rows: auto auto;\n    grid-template-areas:\n      \"icon label\"\n      \"breadcrumb breadcrumb\";\n    align-items: center;\n    padding-left: calc(var(--level, 0) * 0.5em);\n    gap: 0 0.5em;\n  }\n  .blocklyDropDownDiv .blocklyMenuItemLabelIcon {\n    grid-area: icon;\n    width: 1.5em;\n  }\n  .blocklyDropDownDiv .blocklyMenuItemLabelText {\n    grid-area: label;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n  .blocklyDropDownDiv .blocklyMenuItemLabelBreadcrumb {\n    display: none;\n    grid-area: breadcrumb;\n    font-size: 0.75em;\n    opacity: 0.5;\n    min-width: 0;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n  .blocklyDropDownDiv .blocklySearchableMenuSearching .blocklyMenuItemLabel {\n    padding-left: 0;\n  }\n  .blocklyDropDownDiv .blocklySearchableMenuSearching .blocklyMenuItemLabelBreadcrumb {\n    display: block;\n  }\n  `\n);\n","import { defineBlocksWithJsonArray } from \"blockly/core\";\n\nconst keys = [\n  [\"%{BKY_KEYBOARD_KEYPRESSED_ANY}\", \"any\"],\n  [\"%{BKY_KEYBOARD_KEYPRESSED_SPACE}\", \" \"],\n  [\"%{BKY_KEYBOARD_KEYPRESSED_UP}\", \"ArrowUp\"],\n  [\"%{BKY_KEYBOARD_KEYPRESSED_DOWN}\", \"ArrowDown\"],\n  [\"%{BKY_KEYBOARD_KEYPRESSED_RIGHT}\", \"ArrowRight\"],\n  [\"%{BKY_KEYBOARD_KEYPRESSED_LEFT}\", \"ArrowLeft\"],\n  [\"a\", \"a\"],\n  [\"b\", \"b\"],\n  [\"c\", \"c\"],\n  [\"d\", \"d\"],\n  [\"e\", \"e\"],\n  [\"f\", \"f\"],\n  [\"g\", \"g\"],\n  [\"h\", \"h\"],\n  [\"i\", \"i\"],\n  [\"j\", \"j\"],\n  [\"k\", \"k\"],\n  [\"l\", \"l\"],\n  [\"m\", \"m\"],\n  [\"n\", \"n\"],\n  [\"o\", \"o\"],\n  [\"p\", \"p\"],\n  [\"q\", \"q\"],\n  [\"r\", \"r\"],\n  [\"s\", \"s\"],\n  [\"t\", \"t\"],\n  [\"u\", \"u\"],\n  [\"v\", \"v\"],\n  [\"w\", \"w\"],\n  [\"x\", \"x\"],\n  [\"y\", \"y\"],\n  [\"z\", \"z\"],\n  [\"0\", \"0\"],\n  [\"1\", \"1\"],\n  [\"2\", \"2\"],\n  [\"3\", \"3\"],\n  [\"4\", \"4\"],\n  [\"5\", \"5\"],\n  [\"6\", \"6\"],\n  [\"7\", \"7\"],\n  [\"8\", \"8\"],\n  [\"9\", \"9\"],\n];\n\ndefineBlocksWithJsonArray([\n  {\n    type: \"keyboard_keypressed\",\n    message0: \"%{BKY_KEYBOARD_KEYPRESSED}\",\n    args0: [\n      {\n        type: \"field_dropdown\",\n        name: \"KEY\",\n        options: keys,\n      },\n    ],\n    message1: \"%{BKY_KEYBOARD_KEYPRESSED_THEN}\",\n    args1: [\n      {\n        type: \"input_statement\",\n        name: \"STATEMENT\",\n      },\n    ],\n    style: \"trigger_blocks\",\n    tooltip: \"%{BKY_KEYBOARD_KEYPRESSED_TOOLTIP}\",\n    helpUrl: \"%{BKY_KEYBOARD_KEYPRESSED_HELPURL}\",\n  },\n]);\n","import { ref, watchEffect } from \"vue\";\nimport { defineBlocksWithJsonArray, Extensions, Msg } from \"blockly/core\";\nimport { useModule } from \"@metascore-library/core/services/module-manager\";\nimport { EMPTY_OPTION } from \"../constants\";\nimport { watchDrowpdownFieldOptions } from \"../utils\";\n\nconst triggerOptions = ref([]);\nwatchEffect(() => {\n  const { getComponentsByType } = useModule(\"app_components\");\n  const components = getComponentsByType(\"Content\");\n  const parser = new DOMParser();\n  const ids = new Set();\n\n  components.forEach((component) => {\n    const text = component.text;\n\n    if (text && text.includes(\"data-behavior-trigger\")) {\n      const doc = parser.parseFromString(text, \"text/html\");\n      doc.querySelectorAll(\"a[data-behavior-trigger]\").forEach((el) => {\n        const id = el.dataset.behaviorTrigger;\n        ids.add(id);\n      });\n    }\n  });\n\n  if (ids.size === 0) {\n    triggerOptions.value = [[Msg.LINKS_EMPTY_OPTION, EMPTY_OPTION]];\n  } else {\n    triggerOptions.value = Array.from(ids)\n      .sort()\n      .map((id) => [id, id]);\n  }\n});\n\nExtensions.register(\"behavior_triggers_options\", function () {\n  const block = this;\n  const field = block.getField(\"TRIGGER\");\n  const options = field.getOptions();\n\n  if (options.length === 1 && options[0][1] === EMPTY_OPTION) {\n    field.setEnabled(false);\n    block.setEnabled(false);\n    block.setTooltip(Msg.LINKS_CLICK_EMPTY_TOOLTIP);\n  } else {\n    field.setEnabled(true);\n    block.setEnabled(true);\n    block.setTooltip(Msg.LINKS_CLICK_TOOLTIP);\n  }\n\n  // Update the field's dropdown list and value when new options are available.\n  watchDrowpdownFieldOptions(field, triggerOptions);\n});\n\ndefineBlocksWithJsonArray([\n  {\n    type: \"links_click\",\n    message0: \"%{BKY_LINKS_CLICK}\",\n    args0: [\n      {\n        type: \"field_dropdown\",\n        name: \"TRIGGER\",\n        options: () => triggerOptions.value,\n      },\n    ],\n    message1: \"%{BKY_LINKS_CLICK_THEN}\",\n    args1: [\n      {\n        type: \"input_statement\",\n        name: \"STATEMENT\",\n      },\n    ],\n    extensions: [\"behavior_triggers_options\"],\n    style: \"trigger_blocks\",\n    tooltip: \"%{BKY_LINKS_CLICK_TOOLTIP}\",\n    helpUrl: \"%{BKY_LINKS_CLICK_HELPURL}\",\n  },\n  {\n    type: \"links_open_url\",\n    message0: \"%{BKY_LINKS_OPEN_URL}\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"URL\",\n        check: \"String\",\n      },\n    ],\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    helpUrl: \"%{BKY_LINKS_OPEN_URL_HELPURL}\",\n  },\n]);\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as Blockly from 'blockly/core';\n\n/**\n * Returns the extra state of the given block (either as XML or a JSO, depending\n * on the block's definition).\n * @param {!Blockly.BlockSvg} block The block to get the extra state of.\n * @returns {string} A stringified version of the extra state of the given\n *     block.\n */\nexport function getExtraBlockState(block) {\n  // TODO: This is a dupe of the BlockChange.getExtraBlockState code, do we\n  //    want to make that public?\n  if (block.saveExtraState) {\n    const state = block.saveExtraState();\n    return state ? JSON.stringify(state) : '';\n  } else if (block.mutationToDom) {\n    const state = block.mutationToDom();\n    return state ? Blockly.Xml.domToText(state) : '';\n  }\n  return '';\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview A function that creates a minus button used for mutation.\n */\n'use strict';\n\nimport * as Blockly from 'blockly/core';\nimport {getExtraBlockState} from './serialization_helper';\n\n/**\n * Creates a minus image field used for mutation.\n * @param {Object=} args Untyped args passed to block.minus when the field\n *     is clicked.\n * @returns {Blockly.FieldImage} The minus field.\n */\nexport function createMinusField(args = undefined) {\n  const minus = new Blockly.FieldImage(minusImage, 15, 15, undefined, onClick_);\n  /**\n   * Untyped args passed to block.minus when the field is clicked.\n   * @type {?(Object|undefined)}\n   * @private\n   */\n  minus.args_ = args;\n  return minus;\n}\n\n/**\n * Calls block.minus(args) when the minus field is clicked.\n * @param {Blockly.FieldImage} minusField The field being clicked.\n * @private\n */\nfunction onClick_(minusField) {\n  // TODO: This is a dupe of the mutator code, anyway to unify?\n  const block = minusField.getSourceBlock();\n\n  if (block.isInFlyout) {\n    return;\n  }\n\n  Blockly.Events.setGroup(true);\n  const oldExtraState = getExtraBlockState(block);\n  block.minus(minusField.args_);\n  const newExtraState = getExtraBlockState(block);\n\n  if (oldExtraState != newExtraState) {\n    Blockly.Events.fire(\n      new Blockly.Events.BlockChange(\n        block,\n        'mutation',\n        null,\n        oldExtraState,\n        newExtraState,\n      ),\n    );\n  }\n  Blockly.Events.setGroup(false);\n}\n\nconst minusImage =\n  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAw' +\n  'MC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPS' +\n  'JNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAw' +\n  'IDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K';\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview A field for a plus button used for mutation.\n */\n'use strict';\n\nimport * as Blockly from 'blockly/core';\nimport {getExtraBlockState} from './serialization_helper';\n\n/**\n * Creates a plus image field used for mutation.\n * @param {Object=} args Untyped args passed to block.minus when the field\n *     is clicked.\n * @returns {Blockly.FieldImage} The Plus field.\n */\nexport function createPlusField(args = undefined) {\n  const plus = new Blockly.FieldImage(plusImage, 15, 15, undefined, onClick_);\n  /**\n   * Untyped args passed to block.plus when the field is clicked.\n   * @type {?(Object|undefined)}\n   * @private\n   */\n  plus.args_ = args;\n  return plus;\n}\n\n/**\n * Calls block.plus(args) when the plus field is clicked.\n * @param {!Blockly.FieldImage} plusField The field being clicked.\n * @private\n */\nfunction onClick_(plusField) {\n  // TODO: This is a dupe of the mutator code, anyway to unify?\n  const block = plusField.getSourceBlock();\n\n  if (block.isInFlyout) {\n    return;\n  }\n\n  Blockly.Events.setGroup(true);\n  const oldExtraState = getExtraBlockState(block);\n  block.plus(plusField.args_);\n  const newExtraState = getExtraBlockState(block);\n\n  if (oldExtraState != newExtraState) {\n    Blockly.Events.fire(\n      new Blockly.Events.BlockChange(\n        block,\n        'mutation',\n        null,\n        oldExtraState,\n        newExtraState,\n      ),\n    );\n  }\n  Blockly.Events.setGroup(false);\n}\n\nconst plusImage =\n  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC' +\n  '9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMT' +\n  'ggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNz' +\n  'FjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MW' +\n  'MwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS' +\n  '44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==';\n","import {\n  defineBlocksWithJsonArray,\n  Extensions,\n  Msg,\n  FieldCheckbox,\n  FieldLabel,\n} from \"blockly/core\";\nimport { createMinusField } from \"@blockly/block-plus-minus/src/field_minus\";\nimport { createPlusField } from \"@blockly/block-plus-minus/src/field_plus\";\n\ndefineBlocksWithJsonArray([\n  // Block for timecode value\n  {\n    type: \"media_timecode\",\n    message0: \"%1\",\n    args0: [\n      {\n        type: \"field_timecode\",\n        name: \"TIMECODE\",\n      },\n    ],\n    output: \"Number\",\n    style: \"media_blocks\",\n    helpUrl: \"%{BKY_MEDIA_TIMECODE_HELPURL}\",\n    tooltip: \"%{BKY_MEDIA_TIMECODE_TOOLTIP}\",\n    extensions: [\"parent_tooltip_when_inline\"],\n  },\n  {\n    type: \"media_get_duration\",\n    message0: \"%{BKY_MEDIA_GET_DURATION}\",\n    output: \"Number\",\n    style: \"media_blocks\",\n    tooltip: \"%{BKY_MEDIA_GET_DURATION_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_GET_DURATION_HELPURL}\",\n  },\n  {\n    type: \"media_get_time\",\n    message0: \"%{BKY_MEDIA_GET_TIME}\",\n    output: \"Number\",\n    style: \"media_blocks\",\n    tooltip: \"%{BKY_MEDIA_GET_TIME_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_GET_TIME_HELPURL}\",\n  },\n  {\n    type: \"media_set_time\",\n    message0: \"%{BKY_MEDIA_SET_TIME}\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"VALUE\",\n        check: \"Number\",\n      },\n    ],\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_MEDIA_SET_TIME_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_SET_TIME_HELPURL}\",\n  },\n  {\n    type: \"media_playing\",\n    message0: \"%{BKY_MEDIA_PLAYING}\",\n    output: \"Boolean\",\n    style: \"media_blocks\",\n    tooltip: \"%{BKY_MEDIA_PLAYING_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_PLAYING_HELPURL}\",\n  },\n  {\n    type: \"media_play\",\n    message0: \"%{BKY_MEDIA_PLAY}\",\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_MEDIA_PLAY_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_PLAY_HELPURL}\",\n  },\n  {\n    type: \"media_play_excerpt\",\n    message0: \"%{BKY_MEDIA_PLAY_EXCERPT}\",\n    args0: [\n      {\n        type: \"input_dummy\",\n        name: \"PLUS_MINUS\",\n      },\n      {\n        type: \"input_value\",\n        name: \"FROM\",\n        check: \"Number\",\n      },\n      {\n        type: \"input_value\",\n        name: \"TO\",\n        check: \"Number\",\n      },\n      {\n        type: \"input_dummy\",\n        name: \"LINK_HIGHLIGHT\",\n      },\n    ],\n    inputsInline: true,\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    mutator: \"media_play_excerpt_mutator\",\n    tooltip: \"%{BKY_MEDIA_PLAY_EXCERPT_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_PLAY_EXCERPT_HELPURL}\",\n  },\n  // Block representing the top block in the media_play_excerpt mutator.\n  {\n    type: \"media_play_excerpt_top\",\n    message0: \"%{BKY_MEDIA_PLAY_EXCERPT}\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"FROM\",\n        check: \"Number\",\n      },\n      {\n        type: \"input_value\",\n        name: \"TO\",\n        check: \"Number\",\n      },\n    ],\n    inputsInline: true,\n    nextStatement: null,\n    enableContextMenu: false,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_MEDIA_PLAY_EXCERPT_TOP_TOOLTIP}\",\n  },\n  // Block representing the then statement in the media_play_excerpt mutator.\n  {\n    type: \"media_play_excerpt_then\",\n    message0: \"%{BKY_MEDIA_PLAY_EXCERPT_THEN}\",\n    previousStatement: null,\n    enableContextMenu: false,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_MEDIA_PLAY_EXCERPT_THEN_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_PLAY_EXCERPT_THEN_HELPURL}\",\n  },\n  {\n    type: \"media_pause\",\n    message0: \"%{BKY_MEDIA_PAUSE}\",\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_MEDIA_PAUSE_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_PAUSE_HELPURL}\",\n  },\n  {\n    type: \"media_stop\",\n    message0: \"%{BKY_MEDIA_STOP}\",\n    previousStatement: null,\n    nextStatement: null,\n    style: \"actions_blocks\",\n    tooltip: \"%{BKY_MEDIA_STOP_TOOLTIP}\",\n    helpUrl: \"%{BKY_MEDIA_STOP_HELPURL}\",\n  },\n]);\n\n/**\n * Mutator methods added to media_play_excerpt block.\n * @mixin\n * @augments Block\n * @readonly\n */\nconst MEDIA_PLAY_EXCERPT_MUTATOR_MIXIN = {\n  hasThen_: false,\n\n  /**\n   * Returns the state of this block as a JSON serializable object.\n   * @return {?{hasThen: (boolean|undefined)}}\n   *     The state of this block.\n   */\n  saveExtraState: function () {\n    if (!this.hasLinkHighlight_ && !this.hasThen_) {\n      return null;\n    }\n\n    const data = {};\n    if (this.hasLinkHighlight_) {\n      data.hasLinkHighlight = true;\n    }\n    if (this.hasThen_) {\n      data.hasThen = true;\n    }\n    return data;\n  },\n\n  /**\n   * Applies the given state to this block.\n   * @param {*} state The state to apply to this block.\n   */\n  loadExtraState: function (state) {\n    this.hasLinkHighlight_ = state[\"hasLinkHighlight\"] || false;\n    this.hasThen_ = state[\"hasThen\"] || false;\n    this.updateShape_();\n  },\n\n  /**\n   * Callback for the plus field.\n   */\n  plus: function () {\n    this.hasThen_ = true;\n    this.updateShape_();\n  },\n\n  /**\n   * Callback for the minus field.\n   * @this {Blockly.Block}\n   */\n  minus: function () {\n    this.hasThen_ = false;\n    this.updateShape_();\n  },\n\n  /**\n   * Modify this block to have the correct number of inputs.\n   * @this {Block}\n   * @private\n   */\n  updateShape_: function () {\n    const input = this.getInput(\"LINK_HIGHLIGHT\");\n\n    if (this.hasLinkHighlight_) {\n      if (!this.getField(\"HIGHLIGHT_LINK\")) {\n        const checkbox = new FieldCheckbox();\n        checkbox.setTooltip(Msg[\"MEDIA_PLAY_EXCERPT_HIGHLIGHT_LINK_TOOLTIP\"]);\n\n        const label = new FieldLabel(Msg[\"MEDIA_PLAY_EXCERPT_HIGHLIGHT_LINK\"]);\n        label.setTooltip(Msg[\"MEDIA_PLAY_EXCERPT_HIGHLIGHT_LINK_TOOLTIP\"]);\n\n        input\n          .appendField(checkbox, \"HIGHLIGHT_LINK\")\n          .appendField(label, \"HIGHLIGHT_LINK_LABEL\");\n      }\n    } else {\n      input.fieldRow\n        .map((field) => field.name)\n        .forEach((name) => {\n          input.removeField(name);\n        });\n    }\n\n    if (this.hasThen_) {\n      // Update plus/minus buttons.\n      if (this.getField(\"PLUS\")) {\n        this.getInput(\"PLUS_MINUS\").removeField(\"PLUS\");\n      }\n      if (!this.getField(\"MINUS\")) {\n        this.getInput(\"PLUS_MINUS\").appendField(createMinusField(), \"MINUS\");\n      }\n      // Add \"then\" input.\n      if (!this.getInput(\"THEN\")) {\n        this.appendStatementInput(\"THEN\").appendField(\n          Msg[\"MEDIA_PLAY_EXCERPT_THEN\"]\n        );\n      }\n    } else {\n      // Update plus/minus buttons.\n      if (!this.getField(\"PLUS\")) {\n        this.getInput(\"PLUS_MINUS\").appendField(createPlusField(), \"PLUS\");\n      }\n      if (this.getField(\"MINUS\")) {\n        this.getInput(\"PLUS_MINUS\").removeField(\"MINUS\");\n      }\n      // Remove \"then\" input.\n      if (this.getInput(\"THEN\")) {\n        this.removeInput(\"THEN\");\n      }\n    }\n  },\n};\n\n/**\n * Adds the initial plus button.\n * @this {Blockly.Block}\n */\nconst MEDIA_PLAY_EXCERPT_MUTATOR_HELPER = function () {\n  this.setOnChange(function (evt) {\n    if (evt.isUiEvent) return;\n\n    const parent_block = this.getSurroundParent();\n    const hasLinkHighlight =\n      parent_block && parent_block.type === \"links_click\";\n\n    if (this.hasLinkHighlight_ !== hasLinkHighlight) {\n      this.hasLinkHighlight_ = !!hasLinkHighlight;\n      this.updateShape_();\n    }\n  });\n\n  this.updateShape_();\n};\n\nExtensions.registerMutator(\n  \"media_play_excerpt_mutator\",\n  MEDIA_PLAY_EXCERPT_MUTATOR_MIXIN,\n  MEDIA_PLAY_EXCERPT_MUTATOR_HELPER,\n  [\"media_play_excerpt_then\"]\n);\n","import { defineBlocksWithJsonArray } from \"blockly/core\";\n\ndefineBlocksWithJsonArray([\n  {\n    type: \"reactivity_when\",\n    message0: \"%{BKY_REACTIVITY_WHEN}\",\n    args0: [\n      {\n        type: \"input_value\",\n        name: \"CONDITION\",\n        check: \"Boolean\",\n      },\n    ],\n    message1: \"%{BKY_REACTIVITY_WHEN_THEN}\",\n    args1: [\n      {\n        type: \"input_statement\",\n        name: \"STATEMENT\",\n      },\n    ],\n    inputsInline: true,\n    style: \"trigger_blocks\",\n    tooltip: \"%{BKY_REACTIVITY_WHEN_TOOLTIP}\",\n    helpUrl: \"%{BKY_REACTIVITY_WHEN_HELPURL}\",\n  },\n]);\n","import \"./app\";\nimport \"./components\";\nimport \"./keyboard\";\nimport \"./links\";\nimport \"./media\";\nimport \"./reactivity\";\n"],"names":["defineBlocksWithJsonArray","type","message0","message1","args1","name","style","tooltip","helpUrl","previousStatement","nextStatement","watch","UnattachedFieldError","watchDrowpdownFieldOptions","field","optionsRef","block","getSourceBlock","unwatch","newOptions","oldValue","getValue","newOptionsIncludeOldValue","find","option","undefined","newValue","getOptions","setValue","origDestroy","destroy","ref","watchEffect","Extensions","Msg","Css","FieldDropdown","useModule","EMPTY_OPTION","BREADCRUMB_SEPARATOR","SUPPORTED_PROPERTIES","getComponentOptions","components","arguments","length","recursive","level_","breadcrumb_","_useModule","getComponentChildren","getComponentLabel","getComponentIconURL","options","forEach","c","label","icon_url","document","createElement","classList","add","setProperty","icon","src","appendChild","text","createTextNode","breadcrumb","setAttribute","id","push","children","includes","reverse","concat","_toConsumableArray","getPropertyOptions","component_type","COMPONENTS_EMPTY_OPTION","map","property","COMPONENTS_PROPERTY","_useModule2","getModelByType","Object","keys","properties","filter","scenarioOptions","_useModule3","getComponentsByType","value","register","scenario_input","getInput","scenario_field","setEnabled","setTooltip","COMPONENTS_NO_SCENARIO_TOOLTIP","searchable","appendField","blockOptions","_useModule4","block_input","block_field","COMPONENTS_NO_BLOCK_TOOLTIP","componentOptions","_useModule5","_this","component_input","mock","endsWith","component_field","empty_option","default","hidden","COMPONENTS_PROPERTY_MOCK_TOOLTIP","replace","property_","property_input","property_field","component_value","getFieldValue","getComponentType_","PROPERTY_OPTIONS_MUTATOR_MIXIN","saveExtraState","loadExtraState","state","onchange","evt","updatePropertyField_","element","newType","oldType","updateChecks_","_component_value$spli","split","_component_value$spli2","_slicedToArray","getPropertyValueTypeCheck_","property_name","_getModelByType$prope","_useModule6","format","Array","isArray","t","_this2","getField","match","o","property_value","value_input","setCheck","outputConnection","registerMutator","args0","extensions","inputsInline","mutator","output","check","triggerOptions","parser","DOMParser","ids","Set","component","doc","parseFromString","querySelectorAll","el","dataset","behaviorTrigger","size","LINKS_EMPTY_OPTION","from","sort","LINKS_CLICK_EMPTY_TOOLTIP","LINKS_CLICK_TOOLTIP","Blockly","getExtraBlockState","JSON","stringify","mutationToDom","Xml","domToText","createMinusField","args","minus","FieldImage","minusImage","onClick_","args_","minusField","isInFlyout","Events","setGroup","oldExtraState","newExtraState","fire","BlockChange","createPlusField","plus","plusImage","plusField","FieldCheckbox","FieldLabel","enableContextMenu","MEDIA_PLAY_EXCERPT_MUTATOR_MIXIN","hasThen_","hasLinkHighlight_","data","hasLinkHighlight","hasThen","updateShape_","input","checkbox","fieldRow","removeField","appendStatementInput","removeInput","MEDIA_PLAY_EXCERPT_MUTATOR_HELPER","setOnChange","isUiEvent","parent_block","getSurroundParent"],"sourceRoot":""}